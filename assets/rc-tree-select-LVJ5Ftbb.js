import{A as Kr,b as $e,q as _r,K as le,p as or}from"./rc-util-RBoppPtV.js";import{e as K,f as j,h as fr,b as Vr,c as U,g as vr,d as Mr}from"./@babel-Xj_bk_MP.js";import{u as Nr,b as Or,B as Pr}from"./rc-select-fCEKAQLG.js";import{r as t}from"./react-gY946ZKh.js";import{a as Ye,c as Ar,T as Hr}from"./rc-tree-PwHZ_E02.js";import"./classnames-uKr76nPM.js";import"./rc-overflow-WfkOJNdn.js";import"./react-dom-Wc9rTDnX.js";import"./rc-resize-observer-QJ9n6sHl.js";import"./rc-motion-S_lIiSSJ.js";const Rr=function(e){var r=t.useRef({valueLabels:new Map});return t.useMemo(function(){var n=r.current.valueLabels,u=new Map,l=e.map(function(o){var a,c=o.value,i=(a=o.label)!==null&&a!==void 0?a:n.get(c);return u.set(c,i),K(K({},o),{},{label:i})});return r.current.valueLabels=u,[l]},[e])},$r=function(e,r,n,u){return t.useMemo(function(){var l=e.map(function(i){var f=i.value;return f}),o=r.map(function(i){var f=i.value;return f}),a=l.filter(function(i){return!u[i]});if(n){var c=Ye(l,!0,u);l=c.checkedKeys,o=c.halfCheckedKeys}return[Array.from(new Set([].concat(j(a),j(l)))),o]},[e,r,n,u])};function Fr(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Wr(e){var r=e||{},n=r.label,u=r.value,l=r.children,o=u||"value";return{_title:n?[n]:["title","label"],value:o,key:o,children:l||"children"}}function ze(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function jr(e,r){var n=[];function u(l){l.forEach(function(o){var a=o[r.children];a&&(n.push(o[r.value]),u(a))})}return u(e),n}function cr(e){return e==null}const Ur=function(e,r){return t.useMemo(function(){var n=Ar(e,{fieldNames:r,initWrapper:function(l){return K(K({},l),{},{valueEntities:new Map})},processEntity:function(l,o){var a=l.node[r.value];o.valueEntities.set(a,l)}});return n},[e,r])};var hr=function(){return null},Br=["children","value"];function pr(e){return Kr(e).map(function(r){if(!t.isValidElement(r)||!r.type)return null;var n=r,u=n.key,l=n.props,o=l.children,a=l.value,c=fr(l,Br),i=K({key:u,value:a},c),f=pr(o);return f.length&&(i.children=f),i}).filter(function(r){return r})}function Qe(e){if(!e)return e;var r=K({},e);return"props"in r||Object.defineProperty(r,"props",{get:function(){return $e(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),r}}),r}function Gr(e,r,n,u,l,o){var a=null,c=null;function i(){function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(S,A){var x="".concat(I,"-").concat(A),_=S[o.value],H=n.includes(_),B=f(S[o.children]||[],x,H),R=t.createElement(hr,S,B.map(function(g){return g.node}));if(r===_&&(a=R),H){var Z={pos:x,node:R,children:B};return E||c.push(Z),Z}return null}).filter(function(S){return S})}c||(c=[],f(u),c.sort(function(d,I){var E=d.node.props.value,S=I.node.props.value,A=n.indexOf(E),x=n.indexOf(S);return A-x}))}Object.defineProperty(e,"triggerNode",{get:function(){return $e(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),i(),a}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return $e(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),i(),l?c:c.map(function(d){var I=d.node;return I})}})}const qr=function(e,r,n){var u=n.treeNodeFilterProp,l=n.filterTreeNode,o=n.fieldNames,a=o.children;return t.useMemo(function(){if(!r||l===!1)return e;var c;if(typeof l=="function")c=l;else{var i=r.toUpperCase();c=function(I,E){var S=E[u];return String(S).toUpperCase().includes(i)}}function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.reduce(function(E,S){var A=S[a],x=I||c(r,Qe(S)),_=f(A||[],x);return(x||_.length)&&E.push(K(K({},S),{},Vr({isLeaf:void 0},a,_))),E},[])}return f(e)},[e,r,a,u,l])};function dr(e){var r=t.useRef();r.current=e;var n=t.useCallback(function(){return r.current.apply(r,arguments)},[]);return n}function Jr(e,r){var n=r.id,u=r.pId,l=r.rootPId,o={},a=[],c=e.map(function(i){var f=K({},i),d=f[n];return o[d]=f,f.key=f.key||d,f});return c.forEach(function(i){var f=i[u],d=o[f];d&&(d.children=d.children||[],d.children.push(i)),(f===l||!d&&l===null)&&a.push(i)}),a}function Yr(e,r,n){return t.useMemo(function(){return e?n?Jr(e,K({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:pr(r)},[r,n,e])}var mr=t.createContext(null),gr=t.createContext(null),zr={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Qr=function(r,n){var u=Nr(),l=u.prefixCls,o=u.multiple,a=u.searchValue,c=u.toggleOpen,i=u.open,f=u.notFoundContent,d=t.useContext(gr),I=d.virtual,E=d.listHeight,S=d.listItemHeight,A=d.listItemScrollOffset,x=d.treeData,_=d.fieldNames,H=d.onSelect,B=d.dropdownMatchSelectWidth,R=d.treeExpandAction,Z=d.treeTitleRender,g=t.useContext(mr),V=g.checkable,T=g.checkedKeys,ie=g.halfCheckedKeys,ue=g.treeExpandedKeys,We=g.treeDefaultExpandAll,je=g.treeDefaultExpandedKeys,oe=g.onTreeExpand,ke=g.treeIcon,Ee=g.showTreeIcon,xe=g.switcherIcon,De=g.treeLine,we=g.treeNodeFilterProp,Ie=g.loadData,ce=g.treeLoadedKeys,Te=g.treeMotion,Le=g.onTreeLoad,Ke=g.keyEntities,G=t.useRef(),de=_r(function(){return x},[i,x],function(b,h){return h[0]&&b[1]!==h[1]}),_e=t.useState(null),se=U(_e,2),q=se[0],fe=se[1],M=Ke[q],Ve=t.useMemo(function(){return V?{checked:T,halfChecked:ie}:null},[V,T,ie]);t.useEffect(function(){if(i&&!o&&T.length){var b;(b=G.current)===null||b===void 0||b.scrollTo({key:T[0]}),fe(T[0])}},[i]);var ve=String(a).toLowerCase(),Me=function(h){return ve?String(h[we]).toLowerCase().includes(ve):!1},Ne=t.useState(je),he=U(Ne,2),J=he[0],Ue=he[1],Be=t.useState(null),Y=U(Be,2),z=Y[0],pe=Y[1],N=t.useMemo(function(){return ue?j(ue):a?z:J},[J,z,ue,a]);t.useEffect(function(){a&&pe(jr(x,_))},[a]);var Ge=function(h){Ue(h),pe(h),oe&&oe(h)},me=function(h){h.preventDefault()},$=function(h,ee){var O=ee.node;V&&ze(O)||(H(O.key,{selected:!T.includes(O.key)}),o||c(!1))};if(t.useImperativeHandle(n,function(){var b;return{scrollTo:(b=G.current)===null||b===void 0?void 0:b.scrollTo,onKeyDown:function(ee){var O,Oe=ee.which;switch(Oe){case le.UP:case le.DOWN:case le.LEFT:case le.RIGHT:(O=G.current)===null||O===void 0||O.onKeyDown(ee);break;case le.ENTER:{if(M){var ye=(M==null?void 0:M.node)||{},qe=ye.selectable,re=ye.value;qe!==!1&&$(null,{node:{key:q},selected:!T.includes(re)})}break}case le.ESC:c(!1)}},onKeyUp:function(){}}}),de.length===0)return t.createElement("div",{role:"listbox",className:"".concat(l,"-empty"),onMouseDown:me},f);var ge={fieldNames:_};return ce&&(ge.loadedKeys=ce),N&&(ge.expandedKeys=N),t.createElement("div",{onMouseDown:me},M&&i&&t.createElement("span",{style:zr,"aria-live":"assertive"},M.node.value),t.createElement(Hr,vr({ref:G,focusable:!1,prefixCls:"".concat(l,"-tree"),treeData:de,height:E,itemHeight:S,itemScrollOffset:A,virtual:I!==!1&&B!==!1,multiple:o,icon:ke,showIcon:Ee,switcherIcon:xe,showLine:De,loadData:a?null:Ie,motion:Te,activeKey:q,checkable:V,checkStrictly:!0,checkedKeys:Ve,selectedKeys:V?[]:T,defaultExpandAll:We,titleRender:Z},ge,{onActiveChange:fe,onSelect:$,onCheck:$,onExpand:Ge,onLoad:Le,filterTreeNode:Me,expandAction:R})))},Xr=t.forwardRef(Qr),yr="SHOW_ALL",Cr="SHOW_PARENT",Xe="SHOW_CHILD";function sr(e,r,n,u){var l=new Set(e);return r===Xe?e.filter(function(o){var a=n[o];return!(a&&a.children&&a.children.some(function(c){var i=c.node;return l.has(i[u.value])})&&a.children.every(function(c){var i=c.node;return ze(i)||l.has(i[u.value])}))}):r===Cr?e.filter(function(o){var a=n[o],c=a?a.parent:null;return!(c&&!ze(c.node)&&l.has(c.key))}):e}var Zr=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender"];function et(e){return!e||Mr(e)!=="object"}var rt=t.forwardRef(function(e,r){var n=e.id,u=e.prefixCls,l=u===void 0?"rc-tree-select":u,o=e.value,a=e.defaultValue,c=e.onChange,i=e.onSelect,f=e.onDeselect,d=e.searchValue,I=e.inputValue,E=e.onSearch,S=e.autoClearSearchValue,A=S===void 0?!0:S,x=e.filterTreeNode,_=e.treeNodeFilterProp,H=_===void 0?"value":_,B=e.showCheckedStrategy,R=e.treeNodeLabelProp,Z=e.multiple,g=e.treeCheckable,V=e.treeCheckStrictly,T=e.labelInValue,ie=e.fieldNames,ue=e.treeDataSimpleMode,We=e.treeData,je=e.children,oe=e.loadData,ke=e.treeLoadedKeys,Ee=e.onTreeLoad,xe=e.treeDefaultExpandAll,De=e.treeExpandedKeys,we=e.treeDefaultExpandedKeys,Ie=e.onTreeExpand,ce=e.treeExpandAction,Te=e.virtual,Le=e.listHeight,Ke=Le===void 0?200:Le,G=e.listItemHeight,de=G===void 0?20:G,_e=e.listItemScrollOffset,se=_e===void 0?0:_e,q=e.onDropdownVisibleChange,fe=e.dropdownMatchSelectWidth,M=fe===void 0?!0:fe,Ve=e.treeLine,ve=e.treeIcon,Me=e.showTreeIcon,Ne=e.switcherIcon,he=e.treeMotion,J=e.treeTitleRender,Ue=fr(e,Zr),Be=Or(n),Y=g&&!V,z=g||V,pe=V||T,N=z||Z,Ge=or(a,{value:o}),me=U(Ge,2),$=me[0],ge=me[1],b=t.useMemo(function(){return g?B||Xe:yr},[B,g]),h=t.useMemo(function(){return Wr(ie)},[JSON.stringify(ie)]),ee=or("",{value:d!==void 0?d:I,postState:function(s){return s||""}}),O=U(ee,2),Oe=O[0],ye=O[1],qe=function(s){ye(s),E==null||E(s)},re=Yr(We,je,ue),Ze=Ur(re,h),L=Ze.keyEntities,Q=Ze.valueEntities,er=t.useCallback(function(v){var s=[],p=[];return v.forEach(function(y){Q.has(y)?p.push(y):s.push(y)}),{missingRawValues:s,existRawValues:p}},[Q]),rr=qr(re,Oe,{fieldNames:h,treeNodeFilterProp:H,filterTreeNode:x}),tr=t.useCallback(function(v){if(v){if(R)return v[R];for(var s=h._title,p=0;p<s.length;p+=1){var y=v[s[p]];if(y!==void 0)return y}}},[h,R]),Ce=t.useCallback(function(v){var s=Fr(v);return s.map(function(p){return et(p)?{value:p}:p})},[]),Pe=t.useCallback(function(v){var s=Ce(v);return s.map(function(p){var y=p.label,D=p.value,k=p.halfChecked,C,m=Q.get(D);if(m){var w;y=(w=y)!==null&&w!==void 0?w:tr(m.node),C=m.node.disabled}else if(y===void 0){var F=Ce($).find(function(Se){return Se.value===D});y=F.label}return{label:y,value:D,halfChecked:k,disabled:C}})},[Q,tr,Ce,$]),nr=t.useMemo(function(){return Ce($)},[Ce,$]),Sr=t.useMemo(function(){var v=[],s=[];return nr.forEach(function(p){p.halfChecked?s.push(p):v.push(p)}),[v,s]},[nr]),ar=U(Sr,2),te=ar[0],lr=ar[1],ir=t.useMemo(function(){return te.map(function(v){return v.value})},[te]),br=$r(te,lr,Y,L),ur=U(br,2),ne=ur[0],Ae=ur[1],kr=t.useMemo(function(){var v=sr(ne,b,L,h),s=v.map(function(k){var C,m;return(C=(m=L[k])===null||m===void 0||(m=m.node)===null||m===void 0?void 0:m[h.value])!==null&&C!==void 0?C:k}),p=s.map(function(k){var C=te.find(function(w){return w.value===k}),m;return T&&C.label!==void 0?m=C.label:!T&&J&&(m=J(C)),{value:k,label:m}}),y=Pe(p),D=y[0];return!N&&D&&cr(D.value)&&cr(D.label)?[]:y.map(function(k){var C;return K(K({},k),{},{label:(C=k.label)!==null&&C!==void 0?C:k.value})})},[h,N,ne,te,Pe,b,L]),Er=Rr(kr),xr=U(Er,1),Dr=xr[0],He=dr(function(v,s,p){var y=Pe(v);if(ge(y),A&&ye(""),c){var D=v;if(Y){var k=sr(v,b,L,h);D=k.map(function(P){var W=Q.get(P);return W?W.node[h.value]:P})}var C=s||{triggerValue:void 0,selected:void 0},m=C.triggerValue,w=C.selected,F=D;if(V){var Se=lr.filter(function(P){return!D.includes(P.value)});F=[].concat(j(F),j(Se))}var be=Pe(F),X={preValue:te,triggerValue:m},ae=!0;(V||p==="selection"&&!w)&&(ae=!1),Gr(X,m,v,re,ae,h),z?X.checked=w:X.selected=w;var Re=pe?be:be.map(function(P){return P.value});c(N?Re:Re[0],pe?null:be.map(function(P){return P.label}),X)}}),Je=t.useCallback(function(v,s){var p,y=s.selected,D=s.source,k=L[v],C=k==null?void 0:k.node,m=(p=C==null?void 0:C[h.value])!==null&&p!==void 0?p:v;if(!N)He([m],{selected:!0,triggerValue:m},"option");else{var w=y?[].concat(j(ir),[m]):ne.filter(function(W){return W!==m});if(Y){var F=er(w),Se=F.missingRawValues,be=F.existRawValues,X=be.map(function(W){return Q.get(W).key}),ae;if(y){var Re=Ye(X,!0,L);ae=Re.checkedKeys}else{var P=Ye(X,{checked:!1,halfCheckedKeys:Ae},L);ae=P.checkedKeys}w=[].concat(j(Se),j(ae.map(function(W){return L[W].node[h.value]})))}He(w,{selected:y,triggerValue:m},D||"option")}y||!N?i==null||i(m,Qe(C)):f==null||f(m,Qe(C))},[er,Q,L,h,N,ir,He,Y,i,f,ne,Ae]),wr=t.useCallback(function(v){if(q){var s={};Object.defineProperty(s,"documentClickClose",{get:function(){return $e(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),q(v,s)}},[q]),Ir=dr(function(v,s){var p=v.map(function(y){return y.value});if(s.type==="clear"){He(p,{},"selection");return}s.values.length&&Je(s.values[0].value,{selected:!1,source:"selection"})}),Tr=t.useMemo(function(){return{virtual:Te,dropdownMatchSelectWidth:M,listHeight:Ke,listItemHeight:de,listItemScrollOffset:se,treeData:rr,fieldNames:h,onSelect:Je,treeExpandAction:ce,treeTitleRender:J}},[Te,M,Ke,de,se,rr,h,Je,ce,J]),Lr=t.useMemo(function(){return{checkable:z,loadData:oe,treeLoadedKeys:ke,onTreeLoad:Ee,checkedKeys:ne,halfCheckedKeys:Ae,treeDefaultExpandAll:xe,treeExpandedKeys:De,treeDefaultExpandedKeys:we,onTreeExpand:Ie,treeIcon:ve,treeMotion:he,showTreeIcon:Me,switcherIcon:Ne,treeLine:Ve,treeNodeFilterProp:H,keyEntities:L}},[z,oe,ke,Ee,ne,Ae,xe,De,we,Ie,ve,he,Me,Ne,Ve,H,L]);return t.createElement(gr.Provider,{value:Tr},t.createElement(mr.Provider,{value:Lr},t.createElement(Pr,vr({ref:r},Ue,{id:Be,prefixCls:l,mode:N?"multiple":void 0,displayValues:Dr,onDisplayValuesChange:Ir,searchValue:Oe,onSearch:qe,OptionList:Xr,emptyOptions:!re.length,onDropdownVisibleChange:wr,dropdownMatchSelectWidth:M}))))}),Fe=rt;Fe.TreeNode=hr;Fe.SHOW_ALL=yr;Fe.SHOW_PARENT=Cr;Fe.SHOW_CHILD=Xe;export{Fe as G,yr as S,hr as T,Cr as a,Xe as b};
