import{c as H,d as ge,g as ee,b as ue,k as Ne,e as z,f as B}from"./@babel.CqxtU2kl.js";import{r as n,a as J}from"./react.DPZx3FLm.js";import{r as Re}from"./react-dom.stFbKHXB.js";import{c as Z}from"./classnames.CIPFGIzL.js";import{a as pe}from"./rc-motion.cq0Hvde5.js";import{p as Ae,K as Le}from"./rc-util.9PQy9ck0.js";var Pe=n.forwardRef(function(e,a){var d=e.prefixCls,s=e.style,l=e.className,N=e.duration,C=N===void 0?4.5:N,A=e.showProgress,b=e.pauseOnHover,L=b===void 0?!0:b,F=e.eventKey,D=e.content,m=e.closable,g=e.closeIcon,M=g===void 0?"x":g,y=e.props,f=e.onClick,K=e.onNoticeClose,I=e.times,x=e.hovering,S=n.useState(!1),R=H(S,2),u=R[0],h=R[1],o=n.useState(0),t=H(o,2),c=t[0],r=t[1],p=n.useState(0),P=H(p,2),E=P[0],U=P[1],v=x||u,_=C>0&&A,O=function(){K(F)},q=function(i){(i.key==="Enter"||i.code==="Enter"||i.keyCode===Le.ENTER)&&O()};n.useEffect(function(){if(!v&&C>0){var w=Date.now()-E,i=setTimeout(function(){O()},C*1e3-E);return function(){L&&clearTimeout(i),U(Date.now()-w)}}},[C,v,I]),n.useEffect(function(){if(!v&&_&&(L||E===0)){var w=performance.now(),i,k=function ne(){cancelAnimationFrame(i),i=requestAnimationFrame(function(oe){var G=oe+E-w,j=Math.min(G/(C*1e3),1);r(j*100),j<1&&ne()})};return k(),function(){L&&cancelAnimationFrame(i)}}},[C,E,v,_,I]);var V=n.useMemo(function(){return ge(m)==="object"&&m!==null?m:m?{closeIcon:M}:{}},[m,M]),te=Ae(V,!0),Q=100-(!c||c<0?0:c>100?100:c),T="".concat(d,"-notice");return n.createElement("div",ee({},y,{ref:a,className:Z(T,l,ue({},"".concat(T,"-closable"),m)),style:s,onMouseEnter:function(i){var k;h(!0),y==null||(k=y.onMouseEnter)===null||k===void 0||k.call(y,i)},onMouseLeave:function(i){var k;h(!1),y==null||(k=y.onMouseLeave)===null||k===void 0||k.call(y,i)},onClick:f}),n.createElement("div",{className:"".concat(T,"-content")},D),m&&n.createElement("a",ee({tabIndex:0,className:"".concat(T,"-close"),onKeyDown:q,"aria-label":"Close"},te,{onClick:function(i){i.preventDefault(),i.stopPropagation(),O()}}),V.closeIcon),_&&n.createElement("progress",{className:"".concat(T,"-progress"),max:"100",value:Q},Q+"%"))}),he=J.createContext({}),Ge=function(a){var d=a.children,s=a.classNames;return J.createElement(he.Provider,{value:{classNames:s}},d)},de=8,me=3,ye=16,_e=function(a){var d={offset:de,threshold:me,gap:ye};if(a&&ge(a)==="object"){var s,l,N;d.offset=(s=a.offset)!==null&&s!==void 0?s:de,d.threshold=(l=a.threshold)!==null&&l!==void 0?l:me,d.gap=(N=a.gap)!==null&&N!==void 0?N:ye}return[!!a,d]},be=["className","style","classNames","styles"],Me=function(a){var d=a.configList,s=a.placement,l=a.prefixCls,N=a.className,C=a.style,A=a.motion,b=a.onAllNoticeRemoved,L=a.onNoticeClose,F=a.stack,D=n.useContext(he),m=D.classNames,g=n.useRef({}),M=n.useState(null),y=H(M,2),f=y[0],K=y[1],I=n.useState([]),x=H(I,2),S=x[0],R=x[1],u=d.map(function(v){return{config:v,key:String(v.key)}}),h=_e(F),o=H(h,2),t=o[0],c=o[1],r=c.offset,p=c.threshold,P=c.gap,E=t&&(S.length>0||u.length<=p),U=typeof A=="function"?A(s):A;return n.useEffect(function(){t&&S.length>1&&R(function(v){return v.filter(function(_){return u.some(function(O){var q=O.key;return _===q})})})},[S,u,t]),n.useEffect(function(){var v;if(t&&g.current[(v=u[u.length-1])===null||v===void 0?void 0:v.key]){var _;K(g.current[(_=u[u.length-1])===null||_===void 0?void 0:_.key])}},[u,t]),J.createElement(pe,ee({key:s,className:Z(l,"".concat(l,"-").concat(s),m==null?void 0:m.list,N,ue(ue({},"".concat(l,"-stack"),!!t),"".concat(l,"-stack-expanded"),E)),style:C,keys:u,motionAppear:!0},U,{onAllRemoved:function(){b(s)}}),function(v,_){var O=v.config,q=v.className,V=v.style,te=v.index,Q=O,T=Q.key,w=Q.times,i=String(T),k=O,ne=k.className,oe=k.style,G=k.classNames,j=k.styles,ke=Ne(k,be),ae=u.findIndex(function(Y){return Y.key===i}),X={};if(t){var $=u.length-1-(ae>-1?ae:te-1),fe=s==="top"||s==="bottom"?"-50%":"0";if($>0){var re,ie,se;X.height=E?(re=g.current[i])===null||re===void 0?void 0:re.offsetHeight:f==null?void 0:f.offsetHeight;for(var ve=0,ce=0;ce<$;ce++){var le;ve+=((le=g.current[u[u.length-1-ce].key])===null||le===void 0?void 0:le.offsetHeight)+P}var Se=(E?ve:$*r)*(s.startsWith("top")?1:-1),Ee=!E&&f!==null&&f!==void 0&&f.offsetWidth&&(ie=g.current[i])!==null&&ie!==void 0&&ie.offsetWidth?((f==null?void 0:f.offsetWidth)-r*2*($<3?$:3))/((se=g.current[i])===null||se===void 0?void 0:se.offsetWidth):1;X.transform="translate3d(".concat(fe,", ").concat(Se,"px, 0) scaleX(").concat(Ee,")")}else X.transform="translate3d(".concat(fe,", 0, 0)")}return J.createElement("div",{ref:_,className:Z("".concat(l,"-notice-wrapper"),q,G==null?void 0:G.wrapper),style:z(z(z({},V),X),j==null?void 0:j.wrapper),onMouseEnter:function(){return R(function(W){return W.includes(i)?W:[].concat(B(W),[i])})},onMouseLeave:function(){return R(function(W){return W.filter(function(xe){return xe!==i})})}},J.createElement(Pe,ee({},ke,{ref:function(W){ae>-1?g.current[i]=W:delete g.current[i]},prefixCls:l,classNames:G,styles:j,className:Z(ne,m==null?void 0:m.notice),style:oe,times:w,key:T,eventKey:T,onNoticeClose:L,hovering:t&&S.length>0})))})},we=n.forwardRef(function(e,a){var d=e.prefixCls,s=d===void 0?"rc-notification":d,l=e.container,N=e.motion,C=e.maxCount,A=e.className,b=e.style,L=e.onAllRemoved,F=e.stack,D=e.renderNotifications,m=n.useState([]),g=H(m,2),M=g[0],y=g[1],f=function(t){var c,r=M.find(function(p){return p.key===t});r==null||(c=r.onClose)===null||c===void 0||c.call(r),y(function(p){return p.filter(function(P){return P.key!==t})})};n.useImperativeHandle(a,function(){return{open:function(t){y(function(c){var r=B(c),p=r.findIndex(function(U){return U.key===t.key}),P=z({},t);if(p>=0){var E;P.times=(((E=c[p])===null||E===void 0?void 0:E.times)||0)+1,r[p]=P}else P.times=0,r.push(P);return C>0&&r.length>C&&(r=r.slice(-C)),r})},close:function(t){f(t)},destroy:function(){y([])}}});var K=n.useState({}),I=H(K,2),x=I[0],S=I[1];n.useEffect(function(){var o={};M.forEach(function(t){var c=t.placement,r=c===void 0?"topRight":c;r&&(o[r]=o[r]||[],o[r].push(t))}),Object.keys(x).forEach(function(t){o[t]=o[t]||[]}),S(o)},[M]);var R=function(t){S(function(c){var r=z({},c),p=r[t]||[];return p.length||delete r[t],r})},u=n.useRef(!1);if(n.useEffect(function(){Object.keys(x).length>0?u.current=!0:u.current&&(L==null||L(),u.current=!1)},[x]),!l)return null;var h=Object.keys(x);return Re.createPortal(n.createElement(n.Fragment,null,h.map(function(o){var t=x[o],c=n.createElement(Me,{key:o,configList:t,placement:o,prefixCls:s,className:A==null?void 0:A(o),style:b==null?void 0:b(o),motion:N,onNoticeClose:f,onAllNoticeRemoved:R,stack:F});return D?D(c,{prefixCls:s,key:o}):c})),l)}),He=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],Ie=function(){return document.body},Ce=0;function Te(){for(var e={},a=arguments.length,d=new Array(a),s=0;s<a;s++)d[s]=arguments[s];return d.forEach(function(l){l&&Object.keys(l).forEach(function(N){var C=l[N];C!==void 0&&(e[N]=C)})}),e}function Ue(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=e.getContainer,d=a===void 0?Ie:a,s=e.motion,l=e.prefixCls,N=e.maxCount,C=e.className,A=e.style,b=e.onAllRemoved,L=e.stack,F=e.renderNotifications,D=Ne(e,He),m=n.useState(),g=H(m,2),M=g[0],y=g[1],f=n.useRef(),K=n.createElement(we,{container:M,ref:f,prefixCls:l,motion:s,maxCount:N,className:C,style:A,onAllRemoved:b,stack:L,renderNotifications:F}),I=n.useState([]),x=H(I,2),S=x[0],R=x[1],u=n.useMemo(function(){return{open:function(o){var t=Te(D,o);(t.key===null||t.key===void 0)&&(t.key="rc-notification-".concat(Ce),Ce+=1),R(function(c){return[].concat(B(c),[{type:"open",config:t}])})},close:function(o){R(function(t){return[].concat(B(t),[{type:"close",key:o}])})},destroy:function(){R(function(o){return[].concat(B(o),[{type:"destroy"}])})}}},[]);return n.useEffect(function(){y(d())}),n.useEffect(function(){f.current&&S.length&&(S.forEach(function(h){switch(h.type){case"open":f.current.open(h.config);break;case"close":f.current.close(h.key);break;case"destroy":f.current.destroy();break}}),R(function(h){return h.filter(function(o){return!S.includes(o)})}))},[S]),[u,K]}export{Pe as N,Ge as a,Ue as u};
