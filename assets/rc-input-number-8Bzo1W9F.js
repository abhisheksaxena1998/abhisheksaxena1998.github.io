import{b as R,g as j,h as De,c as W,d as ze}from"./@babel-lqQsMmn5.js";import{n as Ve,t as ye,g as I,d as Ce,v as Ge,e as re}from"./@rc-component-35XQ0ZVh.js";import{c as ue}from"./classnames-96-Rrpk_.js";import{B as Je,t as Qe}from"./rc-input-39nXwpyM.js";import{r}from"./react-jw9l9ZC3.js";import{b as Xe,l as Y,L as Ze,f as Me,M as te}from"./rc-util-fvOsdOwp.js";function ea(e,i){var u=r.useRef(null);function y(){try{var v=e.selectionStart,g=e.selectionEnd,c=e.value,N=c.substring(0,v),p=c.substring(g);u.current={start:v,end:g,value:c,beforeTxt:N,afterTxt:p}}catch{}}function d(){if(e&&u.current&&i)try{var v=e.value,g=u.current,c=g.beforeTxt,N=g.afterTxt,p=g.start,l=v.length;if(v.endsWith(N))l=v.length-u.current.afterTxt.length;else if(v.startsWith(c))l=c.length;else{var b=c[p-1],f=v.indexOf(b,p-1);f!==-1&&(l=f+1)}e.setSelectionRange(l,l)}catch(m){Xe(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(m.message))}}return[y,d]}var aa=200,na=600;function ra(e){var i=e.prefixCls,u=e.upNode,y=e.downNode,d=e.upDisabled,v=e.downDisabled,g=e.onStep,c=r.useRef(),N=r.useRef([]),p=r.useRef();p.current=g;var l=function(){clearTimeout(c.current)},b=function(E,D){E.preventDefault(),l(),p.current(D);function A(){p.current(D),c.current=setTimeout(A,aa)}c.current=setTimeout(A,na)};r.useEffect(function(){return function(){l(),N.current.forEach(function(w){return Y.cancel(w)})}},[]);var f=Ze();if(f)return null;var m="".concat(i,"-handler"),x=ue(m,"".concat(m,"-up"),R({},"".concat(m,"-up-disabled"),d)),O=ue(m,"".concat(m,"-down"),R({},"".concat(m,"-down-disabled"),v)),$=function(){return N.current.push(Y(l))},h={unselectable:"on",role:"button",onMouseUp:$,onMouseLeave:$};return r.createElement("div",{className:"".concat(m,"-wrap")},r.createElement("span",j({},h,{onMouseDown:function(E){b(E,!0)},"aria-label":"Increase Value","aria-disabled":d,className:x}),u||r.createElement("span",{unselectable:"on",className:"".concat(i,"-handler-up-inner")})),r.createElement("span",j({},h,{onMouseDown:function(E){b(E,!1)},"aria-label":"Decrease Value","aria-disabled":v,className:O}),y||r.createElement("span",{unselectable:"on",className:"".concat(i,"-handler-down-inner")})))}function Ee(e){var i=typeof e=="number"?Ve(e):ye(e).fullStr,u=i.includes(".");return u?ye(i.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}const ta=function(){var e=r.useRef(0),i=function(){Y.cancel(e.current)};return r.useEffect(function(){return i},[]),function(u){i(),e.current=Y(function(){u()})}};var ua=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur"],sa=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","classes","className","classNames"],Re=function(i,u){return i||u.isEmpty()?u.toString():u.toNumber()},he=function(i){var u=I(i);return u.isInvalidate()?null:u},oa=r.forwardRef(function(e,i){var u,y=e.prefixCls,d=y===void 0?"rc-input-number":y,v=e.className,g=e.style,c=e.min,N=e.max,p=e.step,l=p===void 0?1:p,b=e.defaultValue,f=e.value,m=e.disabled,x=e.readOnly,O=e.upHandler,$=e.downHandler,h=e.keyboard,w=e.controls,E=w===void 0?!0:w,D=e.classNames,A=e.stringMode,H=e.parser,V=e.formatter,M=e.precision,B=e.decimalSeparator,z=e.onChange,G=e.onInput,J=e.onPressEnter,Q=e.onStep,se=e.changeOnBlur,Be=se===void 0?!0:se,_e=De(e,ua),oe="".concat(d,"-input"),T=r.useRef(null),Ue=r.useState(!1),le=W(Ue,2),ie=le[0],ce=le[1],C=r.useRef(!1),F=r.useRef(!1),q=r.useRef(!1),Oe=r.useState(function(){return I(f??b)}),fe=W(Oe,2),o=fe[0],de=fe[1];function $e(n){f===void 0&&de(n)}var X=r.useCallback(function(n,a){if(!a)return M>=0?M:Math.max(Ce(n),Ce(l))},[M,l]),Z=r.useCallback(function(n){var a=String(n);if(H)return H(a);var s=a;return B&&(s=s.replace(B,".")),s.replace(/[^\w.-]+/g,"")},[H,B]),ee=r.useRef(""),ve=r.useCallback(function(n,a){if(V)return V(n,{userTyping:a,input:String(ee.current)});var s=typeof n=="number"?Ve(n):n;if(!a){var t=X(s,a);if(Ge(s)&&(B||t>=0)){var S=B||".";s=re(s,S,t)}}return s},[V,X,B]),Ae=r.useState(function(){var n=b??f;return o.isInvalidate()&&["string","number"].includes(ze(n))?Number.isNaN(n)?"":n:ve(o.toString(),!1)}),me=W(Ae,2),K=me[0],pe=me[1];ee.current=K;function P(n,a){pe(ve(n.isInvalidate()?n.toString(!1):n.toString(!a),a))}var _=r.useMemo(function(){return he(N)},[N,M]),U=r.useMemo(function(){return he(c)},[c,M]),ge=r.useMemo(function(){return!_||!o||o.isInvalidate()?!1:_.lessEquals(o)},[_,o]),Ne=r.useMemo(function(){return!U||!o||o.isInvalidate()?!1:o.lessEquals(U)},[U,o]),Fe=ea(T.current,ie),be=W(Fe,2),Ke=be[0],Pe=be[1],Se=function(a){return _&&!a.lessEquals(_)?_:U&&!U.lessEquals(a)?U:null},ae=function(a){return!Se(a)},L=function(a,s){var t=a,S=ae(t)||t.isEmpty();if(!t.isEmpty()&&!s&&(t=Se(t)||t,S=!0),!x&&!m&&S){var k=t.toString(),ne=X(k,s);return ne>=0&&(t=I(re(k,".",ne)),ae(t)||(t=I(re(k,".",ne,!0)))),t.equals(o)||($e(t),z==null||z(t.isEmpty()?null:Re(A,t)),f===void 0&&P(t,s)),t}return o},ke=ta(),Ie=function n(a){if(Ke(),ee.current=a,pe(a),!F.current){var s=Z(a),t=I(s);t.isNaN()||L(t,!0)}G==null||G(a),ke(function(){var S=a;H||(S=a.replace(/ã€‚/g,".")),S!==a&&n(S)})},He=function(){F.current=!0},Te=function(){F.current=!1,Ie(T.current.value)},qe=function(a){Ie(a.target.value)},xe=function(a){var s;if(!(a&&ge||!a&&Ne)){C.current=!1;var t=I(q.current?Ee(l):l);a||(t=t.negate());var S=(o||I(0)).add(t.toString()),k=L(S,!1);Q==null||Q(Re(A,k),{offset:q.current?Ee(l):l,type:a?"up":"down"}),(s=T.current)===null||s===void 0||s.focus()}},we=function(a){var s=I(Z(K)),t=s;s.isNaN()?t=L(o,a):t=L(s,a),f!==void 0?P(o,!1):t.isNaN()||P(t,!1)},Le=function(){C.current=!0},We=function(a){var s=a.key,t=a.shiftKey;C.current=!0,q.current=t,s==="Enter"&&(F.current||(C.current=!1),we(!1),J==null||J(a)),h!==!1&&!F.current&&["Up","ArrowUp","Down","ArrowDown"].includes(s)&&(xe(s==="Up"||s==="ArrowUp"),a.preventDefault())},je=function(){C.current=!1,q.current=!1},Ye=function(){Be&&we(!1),ce(!1),C.current=!1};return te(function(){o.isInvalidate()||P(o,!1)},[M,V]),te(function(){var n=I(f);de(n);var a=I(Z(K));(!n.equals(a)||!C.current||V)&&P(n,C.current)},[f]),te(function(){V&&Pe()},[K]),r.createElement("div",{className:ue(d,D==null?void 0:D.input,v,(u={},R(u,"".concat(d,"-focused"),ie),R(u,"".concat(d,"-disabled"),m),R(u,"".concat(d,"-readonly"),x),R(u,"".concat(d,"-not-a-number"),o.isNaN()),R(u,"".concat(d,"-out-of-range"),!o.isInvalidate()&&!ae(o)),u)),style:g,onFocus:function(){ce(!0)},onBlur:Ye,onKeyDown:We,onKeyUp:je,onCompositionStart:He,onCompositionEnd:Te,onBeforeInput:Le},E&&r.createElement(ra,{prefixCls:d,upNode:O,downNode:$,upDisabled:ge,downDisabled:Ne,onStep:xe}),r.createElement("div",{className:"".concat(oe,"-wrap")},r.createElement("input",j({autoComplete:"off",role:"spinbutton","aria-valuemin":c,"aria-valuemax":N,"aria-valuenow":o.isInvalidate()?null:o.toString(),step:l},_e,{ref:Me(T,i),className:oe,value:K,onChange:qe,disabled:m,readOnly:x}))))}),la=r.forwardRef(function(e,i){var u=e.disabled,y=e.style,d=e.prefixCls,v=e.value,g=e.prefix,c=e.suffix,N=e.addonBefore,p=e.addonAfter,l=e.classes,b=e.className,f=e.classNames,m=De(e,sa),x=r.useRef(null),O=function(h){x.current&&Qe(x.current,h)};return r.createElement(Je,{inputElement:r.createElement(oa,j({prefixCls:d,disabled:u,classNames:f,ref:Me(x,i)},m)),className:b,triggerFocus:O,prefixCls:d,value:v,disabled:u,style:y,prefix:g,suffix:c,addonAfter:p,addonBefore:N,classes:l,classNames:f,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"}})});la.displayName="InputNumber";export{la as I};
