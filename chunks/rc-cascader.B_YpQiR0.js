import{K as re,e as Ie,d as be}from"./rc-util.9PQy9ck0.js";import{f as Z,e as te,b as H,d as We,c as Y,g as Ae,k as hn}from"./@babel.CqxtU2kl.js";import{u as pn,b as mn,B as gn}from"./rc-select.Dllk844I.js";import{r as o}from"./react.DPZx3FLm.js";import{c as Cn,a as Le}from"./rc-tree.BxqKADDF.js";import{c as ke}from"./classnames.CIPFGIzL.js";import"./rc-overflow.I4o3U_CK.js";import"./react-dom.stFbKHXB.js";import"./rc-resize-observer.XqflEGEn.js";import"./rc-motion.cq0Hvde5.js";import"./react-is.DcfIKM1A.js";var me=o.createContext({}),fe="__rc_cascader_search_mark__",Sn=function(a,n,t){var r=t.label,i=r===void 0?"":r;return n.some(function(u){return String(u[i]).toLowerCase().includes(a.toLowerCase())})},bn=function(a,n,t,r){return n.map(function(i){return i[r.label]}).join(" / ")},yn=function(a,n,t,r,i,u){var l=i.filter,d=l===void 0?Sn:l,v=i.render,m=v===void 0?bn:v,p=i.limit,f=p===void 0?50:p,S=i.sort;return o.useMemo(function(){var s=[];if(!a)return[];function g(y,R){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;y.forEach(function(E){if(!(!S&&f!==!1&&f>0&&s.length>=f)){var M=[].concat(Z(R),[E]),$=E[t.children],k=b||E.disabled;if((!$||$.length===0||u)&&d(a,M,{label:t.label})){var h;s.push(te(te({},E),{},(h={disabled:k},H(h,t.label,m(a,M,r,t)),H(h,fe,M),H(h,t.children,void 0),h)))}$&&g(E[t.children],M,k)}})}return g(n,[]),S&&s.sort(function(y,R){return S(y[fe],R[fe],a,t)}),f!==!1&&f>0?s.slice(0,f):s},[a,n,t,r,m,u,d,S,f])},De="__RC_CASCADER_SPLIT__",He="SHOW_PARENT",Fe="SHOW_CHILD";function ee(e){return e.join(De)}function he(e){return e.map(ee)}function kn(e){return e.split(De)}function Be(e){var a=e||{},n=a.label,t=a.value,r=a.children,i=t||"value";return{label:n||"label",value:i,key:i,children:r||"children"}}function Ce(e,a){var n,t;return(n=e.isLeaf)!==null&&n!==void 0?n:!((t=e[a.children])!==null&&t!==void 0&&t.length)}function _n(e){var a=e.parentElement;if(a){var n=e.offsetTop-a.offsetTop;n-a.scrollTop<0?a.scrollTo({top:n}):n+e.offsetHeight-a.scrollTop>a.offsetHeight&&a.scrollTo({top:n+e.offsetHeight-a.offsetHeight})}}function Ue(e,a){return e.map(function(n){var t;return(t=n[fe])===null||t===void 0?void 0:t.map(function(r){return r[a.value]})})}function xn(e){return Array.isArray(e)&&Array.isArray(e[0])}function ye(e){return e?xn(e)?e:(e.length===0?[]:[e]).map(function(a){return Array.isArray(a)?a:[a]}):[]}function je(e,a,n){var t=new Set(e),r=a();return e.filter(function(i){var u=r[i],l=u?u.parent:null,d=u?u.children:null;return u&&u.node.disabled?!0:n===Fe?!(d&&d.some(function(v){return v.key&&t.has(v.key)})):!(l&&!l.node.disabled&&t.has(l.key))})}function pe(e,a,n){for(var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=a,i=[],u=function(){var v,m,p,f=e[l],S=(v=r)===null||v===void 0?void 0:v.findIndex(function(g){var y=g[n.value];return t?String(y)===String(f):y===f}),s=S!==-1?(m=r)===null||m===void 0?void 0:m[S]:null;i.push({value:(p=s==null?void 0:s[n.value])!==null&&p!==void 0?p:f,index:S,option:s}),r=s==null?void 0:s[n.children]},l=0;l<e.length;l+=1)u();return i}const On=function(e,a,n,t,r){return o.useMemo(function(){var i=r||function(u){var l=t?u.slice(-1):u,d=" / ";return l.every(function(v){return["string","number"].includes(We(v))})?l.join(d):l.reduce(function(v,m,p){var f=o.isValidElement(m)?o.cloneElement(m,{key:p}):m;return p===0?[f]:[].concat(Z(v),[d,f])},[])};return e.map(function(u){var l,d=pe(u,a,n),v=i(d.map(function(p){var f,S=p.option,s=p.value;return(f=S==null?void 0:S[n.label])!==null&&f!==void 0?f:s}),d.map(function(p){var f=p.option;return f})),m=ee(u);return{label:v,value:m,key:m,valueCells:u,disabled:(l=d[d.length-1])===null||l===void 0||(l=l.option)===null||l===void 0?void 0:l.disabled}})},[e,a,n,r,t])};function Je(e,a){return o.useCallback(function(n){var t=[],r=[];return n.forEach(function(i){var u=pe(i,e,a);u.every(function(l){return l.option})?r.push(i):t.push(i)}),[r,t]},[e,a])}const Vn=function(e,a){var n=o.useRef({options:[],info:{keyEntities:{},pathKeyEntities:{}}}),t=o.useCallback(function(){return n.current.options!==e&&(n.current.options=e,n.current.info=Cn(e,{fieldNames:a,initWrapper:function(i){return te(te({},i),{},{pathKeyEntities:{}})},processEntity:function(i,u){var l=i.nodes.map(function(d){return d[a.value]}).join(De);u.pathKeyEntities[l]=i,i.key=l}})),n.current.info.pathKeyEntities},[a,e]);return t};function Xe(e,a){var n=o.useMemo(function(){return a||[]},[a]),t=Vn(n,e),r=o.useCallback(function(i){var u=t();return i.map(function(l){var d=u[l].nodes;return d.map(function(v){return v[e.value]})})},[t,e]);return[n,t,r]}function Pn(e){return o.useMemo(function(){if(!e)return[!1,{}];var a={matchInputWidth:!0,limit:50};return e&&We(e)==="object"&&(a=te(te({},a),e)),a.limit<=0&&(a.limit=!1),[!0,a]},[e])}function qe(e,a,n,t,r,i,u,l){return function(d){if(!e)a(d);else{var v=ee(d),m=he(n),p=he(t),f=m.includes(v),S=r.some(function(k){return ee(k)===v}),s=n,g=r;if(S&&!f)g=r.filter(function(k){return ee(k)!==v});else{var y=f?m.filter(function(k){return k!==v}):[].concat(Z(m),[v]),R=i(),b;if(f){var E=Le(y,{checked:!1,halfCheckedKeys:p},R);b=E.checkedKeys}else{var M=Le(y,!0,R);b=M.checkedKeys}var $=je(b,i,l);s=u($)}a([].concat(Z(g),Z(s)))}}}function Ge(e,a,n,t,r){return o.useMemo(function(){var i=r(a),u=Y(i,2),l=u[0],d=u[1];if(!e||!a.length)return[l,[],d];var v=he(l),m=n(),p=Le(v,!0,m),f=p.checkedKeys,S=p.halfCheckedKeys;return[t(f),t(S),d]},[e,a,n,t,r])}var En=o.memo(function(e){var a=e.children;return a},function(e,a){return!a.open});function wn(e){var a,n=e.prefixCls,t=e.checked,r=e.halfChecked,i=e.disabled,u=e.onClick,l=e.disableCheckbox,d=o.useContext(me),v=d.checkable,m=typeof v!="boolean"?v:null;return o.createElement("span",{className:ke("".concat(n),(a={},H(a,"".concat(n,"-checked"),t),H(a,"".concat(n,"-indeterminate"),!t&&r),H(a,"".concat(n,"-disabled"),i||l),a)),onClick:u},m)}var Ye="__cascader_fix_label__";function Mn(e){var a=e.prefixCls,n=e.multiple,t=e.options,r=e.activeValue,i=e.prevValuePath,u=e.onToggleOpen,l=e.onSelect,d=e.onActive,v=e.checkedSet,m=e.halfCheckedSet,p=e.loadingKeys,f=e.isSelectable,S="".concat(a,"-menu"),s="".concat(a,"-menu-item"),g=o.useContext(me),y=g.fieldNames,R=g.changeOnSelect,b=g.expandTrigger,E=g.expandIcon,M=g.loadingIcon,$=g.dropdownMenuColumnStyle,k=g.optionRender,h=b==="hover",w=o.useMemo(function(){return t.map(function(c){var x,O=c.disabled,V=c.disableCheckbox,W=c[fe],I=(x=c[Ye])!==null&&x!==void 0?x:c[y.label],L=c[y.value],X=Ce(c,y),U=W?W.map(function(j){return j[y.value]}):[].concat(Z(i),[L]),N=ee(U),A=p.includes(N),F=v.has(N),B=m.has(N);return{disabled:O,label:I,value:L,isLeaf:X,isLoading:A,checked:F,halfChecked:B,option:c,disableCheckbox:V,fullPath:U,fullPathKey:N}})},[t,v,y,m,p,i]);return o.createElement("ul",{className:S,role:"menu"},w.map(function(c){var x,O=c.disabled,V=c.label,W=c.value,I=c.isLeaf,L=c.isLoading,X=c.checked,U=c.halfChecked,N=c.option,A=c.fullPath,F=c.fullPathKey,B=c.disableCheckbox,j=function(){if(!O){var T=Z(A);h&&I&&T.pop(),d(T)}},ne=function(){f(N)&&l(A,I)},z;return typeof N.title=="string"?z=N.title:typeof V=="string"&&(z=V),o.createElement("li",{key:F,className:ke(s,(x={},H(x,"".concat(s,"-expand"),!I),H(x,"".concat(s,"-active"),r===W||r===F),H(x,"".concat(s,"-disabled"),O),H(x,"".concat(s,"-loading"),L),x)),style:$,role:"menuitemcheckbox",title:z,"aria-checked":X,"data-path-key":F,onClick:function(){j(),!B&&(!n||I)&&ne()},onDoubleClick:function(){R&&u(!1)},onMouseEnter:function(){h&&j()},onMouseDown:function(T){T.preventDefault()}},n&&o.createElement(wn,{prefixCls:"".concat(a,"-checkbox"),checked:X,halfChecked:U,disabled:O||B,disableCheckbox:B,onClick:function(T){B||(T.stopPropagation(),ne())}}),o.createElement("div",{className:"".concat(s,"-content")},k?k(N):V),!L&&E&&!I&&o.createElement("div",{className:"".concat(s,"-expand-icon")},E),L&&M&&o.createElement("div",{className:"".concat(s,"-loading-icon")},M))}))}var In=function(a,n){var t=o.useContext(me),r=t.values,i=r[0],u=o.useState([]),l=Y(u,2),d=l[0],v=l[1];return o.useEffect(function(){a||v(i||[])},[n,i]),[d,v]};const Ln=function(e,a,n,t,r,i,u){var l=u.direction,d=u.searchValue,v=u.toggleOpen,m=u.open,p=l==="rtl",f=o.useMemo(function(){for(var k=-1,h=a,w=[],c=[],x=t.length,O=Ue(a,n),V=function(U){var N=h.findIndex(function(A,F){return(O[F]?ee(O[F]):A[n.value])===t[U]});if(N===-1)return 1;k=N,w.push(k),c.push(t[U]),h=h[k][n.children]},W=0;W<x&&h&&!V(W);W+=1);for(var I=a,L=0;L<w.length-1;L+=1)I=I[w[L]][n.children];return[c,k,I,O]},[t,n,a]),S=Y(f,4),s=S[0],g=S[1],y=S[2],R=S[3],b=function(h){r(h)},E=function(h){var w=y.length,c=g;c===-1&&h<0&&(c=w);for(var x=0;x<w;x+=1){c=(c+h+w)%w;var O=y[c];if(O&&!O.disabled){var V=s.slice(0,-1).concat(R[c]?ee(R[c]):O[n.value]);b(V);return}}},M=function(){if(s.length>1){var h=s.slice(0,-1);b(h)}else v(!1)},$=function(){var h,w=((h=y[g])===null||h===void 0?void 0:h[n.children])||[],c=w.find(function(O){return!O.disabled});if(c){var x=[].concat(Z(s),[c[n.value]]);b(x)}};o.useImperativeHandle(e,function(){return{onKeyDown:function(h){var w=h.which;switch(w){case re.UP:case re.DOWN:{var c=0;w===re.UP?c=-1:w===re.DOWN&&(c=1),c!==0&&E(c);break}case re.LEFT:{if(d)break;p?$():M();break}case re.RIGHT:{if(d)break;p?M():$();break}case re.BACKSPACE:{d||M();break}case re.ENTER:{if(s.length){var x=y[g],O=(x==null?void 0:x[fe])||[];O.length?i(O.map(function(V){return V[n.value]}),O[O.length-1]):i(s,y[g])}break}case re.ESC:v(!1),m&&h.stopPropagation()}},onKeyUp:function(){}}})};var ze=o.forwardRef(function(e,a){var n,t,r,i=e.prefixCls,u=e.multiple,l=e.searchValue,d=e.toggleOpen,v=e.notFoundContent,m=e.direction,p=e.open,f=o.useRef(null),S=m==="rtl",s=o.useContext(me),g=s.options,y=s.values,R=s.halfValues,b=s.fieldNames,E=s.changeOnSelect,M=s.onSelect,$=s.searchOptions,k=s.dropdownPrefixCls,h=s.loadData,w=s.expandTrigger,c=k||i,x=o.useState([]),O=Y(x,2),V=O[0],W=O[1],I=function(C){if(!(!h||l)){var _=pe(C,g,b),P=_.map(function(ue){var ae=ue.option;return ae}),K=P[P.length-1];if(K&&!Ce(K,b)){var le=ee(C);W(function(ue){return[].concat(Z(ue),[le])}),h(P)}}};o.useEffect(function(){V.length&&V.forEach(function(D){var C=kn(D),_=pe(C,g,b,!0).map(function(K){var le=K.option;return le}),P=_[_.length-1];(!P||P[b.children]||Ce(P,b))&&W(function(K){return K.filter(function(le){return le!==D})})})},[g,V,b]);var L=o.useMemo(function(){return new Set(he(y))},[y]),X=o.useMemo(function(){return new Set(he(R))},[R]),U=In(u,p),N=Y(U,2),A=N[0],F=N[1],B=function(C){F(C),I(C)},j=function(C){var _=C.disabled,P=Ce(C,b);return!_&&(P||E||u)},ne=function(C,_){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;M(C),!u&&(_||E&&(w==="hover"||P))&&d(!1)},z=o.useMemo(function(){return l?$:g},[l,$,g]),q=o.useMemo(function(){for(var D=[{options:z}],C=z,_=Ue(C,b),P=function(){var ue=A[K],ae=C.find(function(_e,Se){return(_[Se]?ee(_[Se]):_e[b.value])===ue}),ce=ae==null?void 0:ae[b.children];if(!(ce!=null&&ce.length))return 1;C=ce,D.push({options:ce})},K=0;K<A.length&&!P();K+=1);return D},[z,A,b]),T=function(C,_){j(_)&&ne(C,Ce(_,b),!0)};Ln(a,z,b,A,B,T,{direction:m,searchValue:l,toggleOpen:d,open:p}),o.useEffect(function(){if(!l)for(var D=0;D<A.length;D+=1){var C,_=A.slice(0,D+1),P=ee(_),K=(C=f.current)===null||C===void 0?void 0:C.querySelector('li[data-path-key="'.concat(P.replace(/\\{0,2}"/g,'\\"'),'"]'));K&&_n(K)}},[A,l]);var se=!((n=q[0])!==null&&n!==void 0&&(n=n.options)!==null&&n!==void 0&&n.length),oe=[(t={},H(t,b.value,"__EMPTY__"),H(t,Ye,v),H(t,"disabled",!0),t)],ve=te(te({},e),{},{multiple:!se&&u,onSelect:ne,onActive:B,onToggleOpen:d,checkedSet:L,halfCheckedSet:X,loadingKeys:V,isSelectable:j}),ie=se?[{options:oe}]:q,G=ie.map(function(D,C){var _=A.slice(0,C),P=A[C];return o.createElement(Mn,Ae({key:C},ve,{prefixCls:c,options:D.options,prevValuePath:_,activeValue:P}))});return o.createElement(En,{open:p},o.createElement("div",{className:ke("".concat(c,"-menus"),(r={},H(r,"".concat(c,"-menu-empty"),se),H(r,"".concat(c,"-rtl"),S),r)),ref:f},G))}),An=o.forwardRef(function(e,a){var n=pn();return o.createElement(ze,Ae({},e,n,{ref:a}))});function Dn(){}function Rn(e){var a,n=e,t=n.prefixCls,r=t===void 0?"rc-cascader":t,i=n.style,u=n.className,l=n.options,d=n.checkable,v=n.defaultValue,m=n.value,p=n.fieldNames,f=n.changeOnSelect,S=n.onChange,s=n.showCheckedStrategy,g=n.loadData,y=n.expandTrigger,R=n.expandIcon,b=R===void 0?">":R,E=n.loadingIcon,M=n.direction,$=n.notFoundContent,k=$===void 0?"Not Found":$,h=!!d,w=Ie(v,{value:m,postState:ye}),c=Y(w,2),x=c[0],O=c[1],V=o.useMemo(function(){return Be(p)},[JSON.stringify(p)]),W=Xe(V,l),I=Y(W,3),L=I[0],X=I[1],U=I[2],N=Je(L,V),A=Ge(h,x,X,U,N),F=Y(A,3),B=F[0],j=F[1],ne=F[2],z=be(function(ie){if(O(ie),S){var G=ye(ie),D=G.map(function(P){return pe(P,L,V).map(function(K){return K.option})}),C=h?G:G[0],_=h?D:D[0];S(C,_)}}),q=qe(h,z,B,j,ne,X,U,s),T=be(function(ie){q(ie)}),se=o.useMemo(function(){return{options:L,fieldNames:V,values:B,halfValues:j,changeOnSelect:f,onSelect:T,checkable:d,searchOptions:[],dropdownPrefixCls:void 0,loadData:g,expandTrigger:y,expandIcon:b,loadingIcon:E,dropdownMenuColumnStyle:void 0}},[L,V,B,j,f,T,d,g,y,b,E]),oe="".concat(r,"-panel"),ve=!L.length;return o.createElement(me.Provider,{value:se},o.createElement("div",{className:ke(oe,(a={},H(a,"".concat(oe,"-rtl"),M==="rtl"),H(a,"".concat(oe,"-empty"),ve),a),u),style:i},ve?k:o.createElement(ze,{prefixCls:r,searchValue:"",multiple:h,toggleOpen:Dn,open:!0,direction:M})))}var Tn=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","autoClearSearchValue","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","dropdownStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy","optionRender"],Re=o.forwardRef(function(e,a){var n=e.id,t=e.prefixCls,r=t===void 0?"rc-cascader":t,i=e.fieldNames,u=e.defaultValue,l=e.value,d=e.changeOnSelect,v=e.onChange,m=e.displayRender,p=e.checkable,f=e.autoClearSearchValue,S=f===void 0?!0:f,s=e.searchValue,g=e.onSearch,y=e.showSearch,R=e.expandTrigger,b=e.options,E=e.dropdownPrefixCls,M=e.loadData,$=e.popupVisible,k=e.open,h=e.popupClassName,w=e.dropdownClassName,c=e.dropdownMenuColumnStyle,x=e.dropdownStyle,O=e.popupPlacement,V=e.placement,W=e.onDropdownVisibleChange,I=e.onPopupVisibleChange,L=e.expandIcon,X=L===void 0?">":L,U=e.loadingIcon,N=e.children,A=e.dropdownMatchSelectWidth,F=A===void 0?!1:A,B=e.showCheckedStrategy,j=B===void 0?He:B,ne=e.optionRender,z=hn(e,Tn),q=mn(n),T=!!p,se=Ie(u,{value:l,postState:ye}),oe=Y(se,2),ve=oe[0],ie=oe[1],G=o.useMemo(function(){return Be(i)},[JSON.stringify(i)]),D=Xe(G,b),C=Y(D,3),_=C[0],P=C[1],K=C[2],le=Ie("",{value:s,postState:function(J){return J||""}}),ue=Y(le,2),ae=ue[0],ce=ue[1],_e=function(J,de){ce(J),de.source!=="blur"&&g&&g(J)},Se=Pn(y),Te=Y(Se,2),Qe=Te[0],Ke=Te[1],xe=yn(ae,_,G,E||r,Ke,d||T),Ze=Je(_,G),en=Ge(T,ve,P,K,Ze),Oe=Y(en,3),ge=Oe[0],Ve=Oe[1],Pe=Oe[2],nn=o.useMemo(function(){var Q=he(ge),J=je(Q,P,j);return[].concat(Z(Pe),Z(K(J)))},[ge,P,K,Pe,j]),an=On(nn,_,G,T,m),Ne=be(function(Q){if(ie(Q),v){var J=ye(Q),de=J.map(function(vn){return pe(vn,_,G).map(function(fn){return fn.option})}),we=T?J:J[0],Me=T?de:de[0];v(we,Me)}}),tn=qe(T,Ne,ge,Ve,Pe,P,K,j),Ee=be(function(Q){(!T||S)&&ce(""),tn(Q)}),rn=function(J,de){if(de.type==="clear"){Ne([]);return}var we=de.values[0],Me=we.valueCells;Ee(Me)},on=k!==void 0?k:$,ln=w||h,un=V||O,cn=function(J){W==null||W(J),I==null||I(J)},sn=o.useMemo(function(){return{options:_,fieldNames:G,values:ge,halfValues:Ve,changeOnSelect:d,onSelect:Ee,checkable:p,searchOptions:xe,dropdownPrefixCls:E,loadData:M,expandTrigger:R,expandIcon:X,loadingIcon:U,dropdownMenuColumnStyle:c,optionRender:ne}},[_,G,ge,Ve,d,Ee,p,xe,E,M,R,X,U,c,ne]),$e=!(ae?xe:_).length,dn=ae&&Ke.matchInputWidth||$e?{}:{minWidth:"auto"};return o.createElement(me.Provider,{value:sn},o.createElement(gn,Ae({},z,{ref:a,id:q,prefixCls:r,autoClearSearchValue:S,dropdownMatchSelectWidth:F,dropdownStyle:te(te({},dn),x),displayValues:an,onDisplayValuesChange:rn,mode:T?"multiple":void 0,searchValue:ae,onSearch:_e,showSearch:Qe,OptionList:An,emptyOptions:$e,open:on,dropdownClassName:ln,placement:un,onDropdownVisibleChange:cn,getRawInputElement:function(){return N}})))});Re.SHOW_PARENT=He;Re.SHOW_CHILD=Fe;Re.Panel=Rn;export{Re as C,Rn as P};
