import{K as e,e as n,d as t}from"./rc-util.DIscDwjl.js";import{f as o,e as r,b as a,d as i,c as l,g as c,k as u}from"./@babel.BGkJ1U9u.js";import{u as s,b as d,B as f}from"./rc-select.BuTKHpzX.js";import{r as p}from"./react.DlfX74Oz.js";import{c as v,a as h}from"./rc-tree.Cc4Zd_Hp.js";import{c as m}from"./classnames.BmZ8OyLm.js";import"./rc-overflow.xAG-NA1s.js";import"./react-dom.tsMZo23m.js";import"./rc-resize-observer.onB48-vm.js";import"./rc-motion.BpKOU8X5.js";import"./react-is.D9jp0pkd.js";var g=p.createContext({}),C="__rc_cascader_search_mark__",b=function(e,n,t){var o=t.label,r=void 0===o?"":o;return n.some((function(n){return String(n[r]).toLowerCase().includes(e.toLowerCase())}))},k=function(e,n,t,o){return n.map((function(e){return e[o.label]})).join(" / ")},y="__RC_CASCADER_SPLIT__",S="SHOW_PARENT",x="SHOW_CHILD";function w(e){return e.join(y)}function E(e){return e.map(w)}function N(e){var n=e||{},t=n.label,o=n.value||"value";return{label:t||"label",value:o,key:o,children:n.children||"children"}}function V(e,n){var t,o;return null!==(t=e.isLeaf)&&void 0!==t?t:!(null!==(o=e[n.children])&&void 0!==o&&o.length)}function P(e){var n=e.parentElement;if(n){var t=e.offsetTop-n.offsetTop;t-n.scrollTop<0?n.scrollTo({top:t}):t+e.offsetHeight-n.scrollTop>n.offsetHeight&&n.scrollTo({top:t+e.offsetHeight-n.offsetHeight})}}function M(e,n){return e.map((function(e){var t;return null===(t=e[C])||void 0===t?void 0:t.map((function(e){return e[n.value]}))}))}function _(e){return e?function(e){return Array.isArray(e)&&Array.isArray(e[0])}(e)?e:(0===e.length?[]:[e]).map((function(e){return Array.isArray(e)?e:[e]})):[]}function O(e,n,t){var o=new Set(e),r=n();return e.filter((function(e){var n=r[e],a=n?n.parent:null,i=n?n.children:null;return!(!n||!n.node.disabled)||(t===x?!(i&&i.some((function(e){return e.key&&o.has(e.key)}))):!(a&&!a.node.disabled&&o.has(a.key)))}))}function I(e,n,t){for(var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=n,a=[],i=function(){var n,i,c,u=e[l],s=null===(n=r)||void 0===n?void 0:n.findIndex((function(e){var n=e[t.value];return o?String(n)===String(u):n===u})),d=-1!==s?null===(i=r)||void 0===i?void 0:i[s]:null;a.push({value:null!==(c=null==d?void 0:d[t.value])&&void 0!==c?c:u,index:s,option:d}),r=null==d?void 0:d[t.children]},l=0;l<e.length;l+=1)i();return a}function T(e,n){return p.useCallback((function(t){var o=[],r=[];return t.forEach((function(t){I(t,e,n).every((function(e){return e.option}))?r.push(t):o.push(t)})),[r,o]}),[e,n])}function D(e,n){var t=p.useMemo((function(){return n||[]}),[n]),o=function(e,n){var t=p.useRef({options:[],info:{keyEntities:{},pathKeyEntities:{}}});return p.useCallback((function(){return t.current.options!==e&&(t.current.options=e,t.current.info=v(e,{fieldNames:n,initWrapper:function(e){return r(r({},e),{},{pathKeyEntities:{}})},processEntity:function(e,t){var o=e.nodes.map((function(e){return e[n.value]})).join(y);t.pathKeyEntities[o]=e,e.key=o}})),t.current.info.pathKeyEntities}),[n,e])}(t,e),a=p.useCallback((function(n){var t=o();return n.map((function(n){return t[n].nodes.map((function(n){return n[e.value]}))}))}),[o,e]);return[t,o,a]}function R(e,n,t,r,a,i,l,c){return function(u){if(e){var s=w(u),d=E(t),f=E(r),p=d.includes(s),v=a.some((function(e){return w(e)===s})),m=t,g=a;if(v&&!p)g=a.filter((function(e){return w(e)!==s}));else{var C,b=p?d.filter((function(e){return e!==s})):[].concat(o(d),[s]),k=i();if(p)C=h(b,{checked:!1,halfCheckedKeys:f},k).checkedKeys;else C=h(b,!0,k).checkedKeys;var y=O(C,i,c);m=l(y)}n([].concat(o(g),o(m)))}else n(u)}}function j(e,n,t,o,r){return p.useMemo((function(){var a=r(n),i=l(a,2),c=i[0],u=i[1];if(!e||!n.length)return[c,[],u];var s=E(c),d=t(),f=h(s,!0,d),p=f.checkedKeys,v=f.halfCheckedKeys;return[o(p),o(v),u]}),[e,n,t,o,r])}var K=p.memo((function(e){return e.children}),(function(e,n){return!n.open}));function A(e){var n,t=e.prefixCls,o=e.checked,r=e.halfChecked,i=e.disabled,l=e.onClick,c=e.disableCheckbox,u=p.useContext(g).checkable,s="boolean"!=typeof u?u:null;return p.createElement("span",{className:m("".concat(t),(n={},a(n,"".concat(t,"-checked"),o),a(n,"".concat(t,"-indeterminate"),!o&&r),a(n,"".concat(t,"-disabled"),i||c),n)),onClick:l},s)}var W="__cascader_fix_label__";function H(e){var n=e.prefixCls,t=e.multiple,r=e.options,i=e.activeValue,l=e.prevValuePath,c=e.onToggleOpen,u=e.onSelect,s=e.onActive,d=e.checkedSet,f=e.halfCheckedSet,v=e.loadingKeys,h=e.isSelectable,b="".concat(n,"-menu"),k="".concat(n,"-menu-item"),y=p.useContext(g),S=y.fieldNames,x=y.changeOnSelect,E=y.expandTrigger,N=y.expandIcon,P=y.loadingIcon,M=y.dropdownMenuColumnStyle,_=y.optionRender,O="hover"===E,I=p.useMemo((function(){return r.map((function(e){var n,t=e.disabled,r=e.disableCheckbox,a=e[C],i=null!==(n=e[W])&&void 0!==n?n:e[S.label],c=e[S.value],u=V(e,S),s=a?a.map((function(e){return e[S.value]})):[].concat(o(l),[c]),p=w(s);return{disabled:t,label:i,value:c,isLeaf:u,isLoading:v.includes(p),checked:d.has(p),halfChecked:f.has(p),option:e,disableCheckbox:r,fullPath:s,fullPathKey:p}}))}),[r,d,S,f,v,l]);return p.createElement("ul",{className:b,role:"menu"},I.map((function(e){var r,l,d=e.disabled,f=e.label,v=e.value,g=e.isLeaf,C=e.isLoading,b=e.checked,y=e.halfChecked,S=e.option,w=e.fullPath,E=e.fullPathKey,V=e.disableCheckbox,I=function(){if(!d){var e=o(w);O&&g&&e.pop(),s(e)}},T=function(){h(S)&&u(w,g)};return"string"==typeof S.title?l=S.title:"string"==typeof f&&(l=f),p.createElement("li",{key:E,className:m(k,(r={},a(r,"".concat(k,"-expand"),!g),a(r,"".concat(k,"-active"),i===v||i===E),a(r,"".concat(k,"-disabled"),d),a(r,"".concat(k,"-loading"),C),r)),style:M,role:"menuitemcheckbox",title:l,"aria-checked":b,"data-path-key":E,onClick:function(){I(),V||t&&!g||T()},onDoubleClick:function(){x&&c(!1)},onMouseEnter:function(){O&&I()},onMouseDown:function(e){e.preventDefault()}},t&&p.createElement(A,{prefixCls:"".concat(n,"-checkbox"),checked:b,halfChecked:y,disabled:d||V,disableCheckbox:V,onClick:function(e){V||(e.stopPropagation(),T())}}),p.createElement("div",{className:"".concat(k,"-content")},_?_(S):f),!C&&N&&!g&&p.createElement("div",{className:"".concat(k,"-expand-icon")},N),C&&P&&p.createElement("div",{className:"".concat(k,"-loading-icon")},P))})))}const L=function(n,t,r,a,i,c,u){var s=u.direction,d=u.searchValue,f=u.toggleOpen,v=u.open,h="rtl"===s,m=p.useMemo((function(){for(var e=-1,n=t,o=[],i=[],l=a.length,c=M(t,r),u=function(t){var l=n.findIndex((function(e,n){return(c[n]?w(c[n]):e[r.value])===a[t]}));if(-1===l)return 1;e=l,o.push(e),i.push(a[t]),n=n[e][r.children]},s=0;s<l&&n&&!u(s);s+=1);for(var d=t,f=0;f<o.length-1;f+=1)d=d[o[f]][r.children];return[i,e,d,c]}),[a,r,t]),g=l(m,4),b=g[0],k=g[1],y=g[2],S=g[3],x=function(e){i(e)},E=function(){if(b.length>1){var e=b.slice(0,-1);x(e)}else f(!1)},N=function(){var e,n=((null===(e=y[k])||void 0===e?void 0:e[r.children])||[]).find((function(e){return!e.disabled}));if(n){var t=[].concat(o(b),[n[r.value]]);x(t)}};p.useImperativeHandle(n,(function(){return{onKeyDown:function(n){var t=n.which;switch(t){case e.UP:case e.DOWN:var o=0;t===e.UP?o=-1:t===e.DOWN&&(o=1),0!==o&&function(e){var n=y.length,t=k;-1===t&&e<0&&(t=n);for(var o=0;o<n;o+=1){var a=y[t=(t+e+n)%n];if(a&&!a.disabled){var i=b.slice(0,-1).concat(S[t]?w(S[t]):a[r.value]);return void x(i)}}}(o);break;case e.LEFT:if(d)break;h?N():E();break;case e.RIGHT:if(d)break;h?E():N();break;case e.BACKSPACE:d||E();break;case e.ENTER:if(b.length){var a=y[k],i=(null==a?void 0:a[C])||[];i.length?c(i.map((function(e){return e[r.value]})),i[i.length-1]):c(b,y[k])}break;case e.ESC:f(!1),v&&n.stopPropagation()}},onKeyUp:function(){}}}))};var F=p.forwardRef((function(e,n){var t,i,u,s=e.prefixCls,d=e.multiple,f=e.searchValue,v=e.toggleOpen,h=e.notFoundContent,C=e.direction,b=e.open,k=p.useRef(null),S="rtl"===C,x=p.useContext(g),N=x.options,_=x.values,O=x.halfValues,T=x.fieldNames,D=x.changeOnSelect,R=x.onSelect,j=x.searchOptions,A=x.dropdownPrefixCls,F=x.loadData,U=x.expandTrigger,B=A||s,G=p.useState([]),J=l(G,2),q=J[0],z=J[1];p.useEffect((function(){q.length&&q.forEach((function(e){var n=I(e.split(y),N,T,!0).map((function(e){return e.option})),t=n[n.length-1];(!t||t[T.children]||V(t,T))&&z((function(n){return n.filter((function(n){return n!==e}))}))}))}),[N,q,T]);var Y=p.useMemo((function(){return new Set(E(_))}),[_]),$=p.useMemo((function(){return new Set(E(O))}),[O]),Q=function(e,n){var t=p.useContext(g).values[0],o=p.useState([]),r=l(o,2),a=r[0],i=r[1];return p.useEffect((function(){e||i(t||[])}),[n,t]),[a,i]}(d,b),X=l(Q,2),Z=X[0],ee=X[1],ne=function(e){ee(e),function(e){if(F&&!f){var n=I(e,N,T).map((function(e){return e.option})),t=n[n.length-1];if(t&&!V(t,T)){var r=w(e);z((function(e){return[].concat(o(e),[r])})),F(n)}}}(e)},te=function(e){var n=e.disabled,t=V(e,T);return!n&&(t||D||d)},oe=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];R(e),!d&&(n||D&&("hover"===U||t))&&v(!1)},re=p.useMemo((function(){return f?j:N}),[f,j,N]),ae=p.useMemo((function(){for(var e=[{options:re}],n=re,t=M(n,T),o=function(){var o=Z[r],a=n.find((function(e,n){return(t[n]?w(t[n]):e[T.value])===o})),i=null==a?void 0:a[T.children];if(null==i||!i.length)return 1;n=i,e.push({options:i})},r=0;r<Z.length&&!o();r+=1);return e}),[re,Z,T]);L(n,re,T,Z,ne,(function(e,n){te(n)&&oe(e,V(n,T),!0)}),{direction:C,searchValue:f,toggleOpen:v,open:b}),p.useEffect((function(){if(!f)for(var e=0;e<Z.length;e+=1){var n,t=w(Z.slice(0,e+1)),o=null===(n=k.current)||void 0===n?void 0:n.querySelector('li[data-path-key="'.concat(t.replace(/\\{0,2}"/g,'\\"'),'"]'));o&&P(o)}}),[Z,f]);var ie=!(null!==(t=ae[0])&&void 0!==t&&null!==(t=t.options)&&void 0!==t&&t.length),le=[(i={},a(i,T.value,"__EMPTY__"),a(i,W,h),a(i,"disabled",!0),i)],ce=r(r({},e),{},{multiple:!ie&&d,onSelect:oe,onActive:ne,onToggleOpen:v,checkedSet:Y,halfCheckedSet:$,loadingKeys:q,isSelectable:te}),ue=(ie?[{options:le}]:ae).map((function(e,n){var t=Z.slice(0,n),o=Z[n];return p.createElement(H,c({key:n},ce,{prefixCls:B,options:e.options,prevValuePath:t,activeValue:o}))}));return p.createElement(K,{open:b},p.createElement("div",{className:m("".concat(B,"-menus"),(u={},a(u,"".concat(B,"-menu-empty"),ie),a(u,"".concat(B,"-rtl"),S),u)),ref:k},ue))})),U=p.forwardRef((function(e,n){var t=s();return p.createElement(F,c({},e,t,{ref:n}))}));function B(){}function G(e){var o,r=e,i=r.prefixCls,c=void 0===i?"rc-cascader":i,u=r.style,s=r.className,d=r.options,f=r.checkable,v=r.defaultValue,h=r.value,C=r.fieldNames,b=r.changeOnSelect,k=r.onChange,y=r.showCheckedStrategy,S=r.loadData,x=r.expandTrigger,w=r.expandIcon,E=void 0===w?">":w,V=r.loadingIcon,P=r.direction,M=r.notFoundContent,O=void 0===M?"Not Found":M,K=!!f,A=n(v,{value:h,postState:_}),W=l(A,2),H=W[0],L=W[1],U=p.useMemo((function(){return N(C)}),[JSON.stringify(C)]),G=D(U,d),J=l(G,3),q=J[0],z=J[1],Y=J[2],$=T(q,U),Q=j(K,H,z,Y,$),X=l(Q,3),Z=X[0],ee=X[1],ne=X[2],te=t((function(e){if(L(e),k){var n=_(e),t=n.map((function(e){return I(e,q,U).map((function(e){return e.option}))})),o=K?n:n[0],r=K?t:t[0];k(o,r)}})),oe=R(K,te,Z,ee,ne,z,Y,y),re=t((function(e){oe(e)})),ae=p.useMemo((function(){return{options:q,fieldNames:U,values:Z,halfValues:ee,changeOnSelect:b,onSelect:re,checkable:f,searchOptions:[],dropdownPrefixCls:void 0,loadData:S,expandTrigger:x,expandIcon:E,loadingIcon:V,dropdownMenuColumnStyle:void 0}}),[q,U,Z,ee,b,re,f,S,x,E,V]),ie="".concat(c,"-panel"),le=!q.length;return p.createElement(g.Provider,{value:ae},p.createElement("div",{className:m(ie,(o={},a(o,"".concat(ie,"-rtl"),"rtl"===P),a(o,"".concat(ie,"-empty"),le),o),s),style:u},le?O:p.createElement(F,{prefixCls:c,searchValue:"",multiple:K,toggleOpen:B,open:!0,direction:P})))}var J=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","autoClearSearchValue","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","dropdownStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy","optionRender"],q=p.forwardRef((function(e,s){var v=e.id,h=e.prefixCls,m=void 0===h?"rc-cascader":h,y=e.fieldNames,x=e.defaultValue,V=e.value,P=e.changeOnSelect,M=e.onChange,K=e.displayRender,A=e.checkable,W=e.autoClearSearchValue,H=void 0===W||W,L=e.searchValue,F=e.onSearch,B=e.showSearch,G=e.expandTrigger,q=e.options,z=e.dropdownPrefixCls,Y=e.loadData,$=e.popupVisible,Q=e.open,X=e.popupClassName,Z=e.dropdownClassName,ee=e.dropdownMenuColumnStyle,ne=e.dropdownStyle,te=e.popupPlacement,oe=e.placement,re=e.onDropdownVisibleChange,ae=e.onPopupVisibleChange,ie=e.expandIcon,le=void 0===ie?">":ie,ce=e.loadingIcon,ue=e.children,se=e.dropdownMatchSelectWidth,de=void 0!==se&&se,fe=e.showCheckedStrategy,pe=void 0===fe?S:fe,ve=e.optionRender,he=u(e,J),me=d(v),ge=!!A,Ce=n(x,{value:V,postState:_}),be=l(Ce,2),ke=be[0],ye=be[1],Se=p.useMemo((function(){return N(y)}),[JSON.stringify(y)]),xe=D(Se,q),we=l(xe,3),Ee=we[0],Ne=we[1],Ve=we[2],Pe=n("",{value:L,postState:function(e){return e||""}}),Me=l(Pe,2),_e=Me[0],Oe=Me[1],Ie=function(e){return p.useMemo((function(){if(!e)return[!1,{}];var n={matchInputWidth:!0,limit:50};return e&&"object"===i(e)&&(n=r(r({},n),e)),n.limit<=0&&(n.limit=!1),[!0,n]}),[e])}(B),Te=l(Ie,2),De=Te[0],Re=Te[1],je=function(e,n,t,i,l,c){var u=l.filter,s=void 0===u?b:u,d=l.render,f=void 0===d?k:d,v=l.limit,h=void 0===v?50:v,m=l.sort;return p.useMemo((function(){var l=[];return e?(function n(u,d){var p=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u.forEach((function(u){if(!(!m&&!1!==h&&h>0&&l.length>=h)){var v,g=[].concat(o(d),[u]),b=u[t.children],k=p||u.disabled;b&&0!==b.length&&!c||s(e,g,{label:t.label})&&l.push(r(r({},u),{},(a(v={disabled:k},t.label,f(e,g,i,t)),a(v,C,g),a(v,t.children,void 0),v))),b&&n(u[t.children],g,k)}}))}(n,[]),m&&l.sort((function(n,o){return m(n[C],o[C],e,t)})),!1!==h&&h>0?l.slice(0,h):l):[]}),[e,n,t,i,f,c,s,m,h])}(_e,Ee,Se,z||m,Re,P||ge),Ke=T(Ee,Se),Ae=j(ge,ke,Ne,Ve,Ke),We=l(Ae,3),He=We[0],Le=We[1],Fe=We[2],Ue=function(e,n,t,r,a){return p.useMemo((function(){var l=a||function(e){var n=r?e.slice(-1):e;return n.every((function(e){return["string","number"].includes(i(e))}))?n.join(" / "):n.reduce((function(e,n,t){var r=p.isValidElement(n)?p.cloneElement(n,{key:t}):n;return 0===t?[r]:[].concat(o(e),[" / ",r])}),[])};return e.map((function(e){var o,r=I(e,n,t),a=l(r.map((function(e){var n,o=e.option,r=e.value;return null!==(n=null==o?void 0:o[t.label])&&void 0!==n?n:r})),r.map((function(e){return e.option}))),i=w(e);return{label:a,value:i,key:i,valueCells:e,disabled:null===(o=r[r.length-1])||void 0===o||null===(o=o.option)||void 0===o?void 0:o.disabled}}))}),[e,n,t,a,r])}(p.useMemo((function(){var e=O(E(He),Ne,pe);return[].concat(o(Fe),o(Ve(e)))}),[He,Ne,Ve,Fe,pe]),Ee,Se,ge,K),Be=t((function(e){if(ye(e),M){var n=_(e),t=n.map((function(e){return I(e,Ee,Se).map((function(e){return e.option}))})),o=ge?n:n[0],r=ge?t:t[0];M(o,r)}})),Ge=R(ge,Be,He,Le,Fe,Ne,Ve,pe),Je=t((function(e){ge&&!H||Oe(""),Ge(e)})),qe=void 0!==Q?Q:$,ze=Z||X,Ye=oe||te,$e=p.useMemo((function(){return{options:Ee,fieldNames:Se,values:He,halfValues:Le,changeOnSelect:P,onSelect:Je,checkable:A,searchOptions:je,dropdownPrefixCls:z,loadData:Y,expandTrigger:G,expandIcon:le,loadingIcon:ce,dropdownMenuColumnStyle:ee,optionRender:ve}}),[Ee,Se,He,Le,P,Je,A,je,z,Y,G,le,ce,ee,ve]),Qe=!(_e?je:Ee).length,Xe=_e&&Re.matchInputWidth||Qe?{}:{minWidth:"auto"};return p.createElement(g.Provider,{value:$e},p.createElement(f,c({},he,{ref:s,id:me,prefixCls:m,autoClearSearchValue:H,dropdownMatchSelectWidth:de,dropdownStyle:r(r({},Xe),ne),displayValues:Ue,onDisplayValuesChange:function(e,n){if("clear"!==n.type){var t=n.values[0].valueCells;Je(t)}else Be([])},mode:ge?"multiple":void 0,searchValue:_e,onSearch:function(e,n){Oe(e),"blur"!==n.source&&F&&F(e)},showSearch:De,OptionList:U,emptyOptions:Qe,open:qe,dropdownClassName:ze,placement:Ye,onDropdownVisibleChange:function(e){null==re||re(e),null==ae||ae(e)},getRawInputElement:function(){return ue}})))}));q.SHOW_PARENT=S,q.SHOW_CHILD=x,q.Panel=G;export{q as C,G as P};
