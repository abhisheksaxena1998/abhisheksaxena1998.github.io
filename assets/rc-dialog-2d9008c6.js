import{g as w,e as C,c as Y}from"./@babel-43e769cc.js";import{P as ce}from"./@rc-component-73db1337.js";import{r as n,a as s}from"./react-d998b26c.js";import{c as W}from"./classnames-325479d5.js";import{e as fe,n as ue,x as me,E as F,K as G}from"./rc-util-6fbd7337.js";import{C as p}from"./rc-motion-1104756f.js";import"./react-is-e8e5dbb3.js";var ee=n.createContext({});function J(e,a,t){var o=a;return!o&&t&&(o="".concat(e,"-").concat(t)),o}function Q(e,a){var t=e["page".concat(a?"Y":"X","Offset")],o="scroll".concat(a?"Top":"Left");if(typeof t!="number"){var r=e.document;t=r.documentElement[o],typeof t!="number"&&(t=r.body[o])}return t}function de(e){var a=e.getBoundingClientRect(),t={left:a.left,top:a.top},o=e.ownerDocument,r=o.defaultView||o.parentWindow;return t.left+=Q(r),t.top+=Q(r,!0),t}const ve=n.memo(function(e){var a=e.children;return a},function(e,a){var t=a.shouldUpdate;return!t});var Z={width:0,height:0,overflow:"hidden",outline:"none"},Ce=s.forwardRef(function(e,a){var t=e.prefixCls,o=e.className,r=e.style,i=e.title,c=e.ariaId,f=e.footer,u=e.closable,y=e.closeIcon,N=e.onClose,b=e.children,d=e.bodyStyle,v=e.bodyProps,g=e.modalRender,h=e.onMouseDown,P=e.onMouseUp,M=e.holderRef,E=e.visible,I=e.forceRender,m=e.width,k=e.height,A=s.useContext(ee),O=A.panel,K=fe(M,O),_=n.useRef(),$=n.useRef();s.useImperativeHandle(a,function(){return{focus:function(){var R;(R=_.current)===null||R===void 0||R.focus()},changeActive:function(R){var U=document,V=U.activeElement;R&&V===$.current?_.current.focus():!R&&V===_.current&&$.current.focus()}}});var T={};m!==void 0&&(T.width=m),k!==void 0&&(T.height=k);var z;f&&(z=s.createElement("div",{className:"".concat(t,"-footer")},f));var x;i&&(x=s.createElement("div",{className:"".concat(t,"-header")},s.createElement("div",{className:"".concat(t,"-title"),id:c},i)));var S;u&&(S=s.createElement("button",{type:"button",onClick:N,"aria-label":"Close",className:"".concat(t,"-close")},y||s.createElement("span",{className:"".concat(t,"-close-x")})));var D=s.createElement("div",{className:"".concat(t,"-content")},S,x,s.createElement("div",w({className:"".concat(t,"-body"),style:d},v),b),z);return s.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":i?c:null,"aria-modal":"true",ref:K,style:C(C({},r),T),className:W(t,o),onMouseDown:h,onMouseUp:P},s.createElement("div",{tabIndex:0,ref:_,style:Z,"aria-hidden":"true"}),s.createElement(ve,{shouldUpdate:E||I},g?g(D):D),s.createElement("div",{tabIndex:0,ref:$,style:Z,"aria-hidden":"true"}))}),te=n.forwardRef(function(e,a){var t=e.prefixCls,o=e.title,r=e.style,i=e.className,c=e.visible,f=e.forceRender,u=e.destroyOnClose,y=e.motionName,N=e.ariaId,b=e.onVisibleChanged,d=e.mousePosition,v=n.useRef(),g=n.useState(),h=Y(g,2),P=h[0],M=h[1],E={};P&&(E.transformOrigin=P);function I(){var m=de(v.current);M(d?"".concat(d.x-m.left,"px ").concat(d.y-m.top,"px"):"")}return n.createElement(p,{visible:c,onVisibleChanged:b,onAppearPrepare:I,onEnterPrepare:I,forceRender:f,motionName:y,removeOnLeave:u,ref:v},function(m,k){var A=m.className,O=m.style;return n.createElement(Ce,w({},e,{ref:a,title:o,ariaId:N,prefixCls:t,holderRef:k,style:C(C(C({},O),r),E),className:W(i,A)}))})});te.displayName="Content";function ye(e){var a=e.prefixCls,t=e.style,o=e.visible,r=e.maskProps,i=e.motionName;return n.createElement(p,{key:"mask",visible:o,motionName:i,leavedClassName:"".concat(a,"-mask-hidden")},function(c,f){var u=c.className,y=c.style;return n.createElement("div",w({ref:f,style:C(C({},y),t),className:W("".concat(a,"-mask"),u)},r))})}function be(e){var a=e.prefixCls,t=a===void 0?"rc-dialog":a,o=e.zIndex,r=e.visible,i=r===void 0?!1:r,c=e.keyboard,f=c===void 0?!0:c,u=e.focusTriggerAfterClose,y=u===void 0?!0:u,N=e.wrapStyle,b=e.wrapClassName,d=e.wrapProps,v=e.onClose,g=e.afterOpenChange,h=e.afterClose,P=e.transitionName,M=e.animation,E=e.closable,I=E===void 0?!0:E,m=e.mask,k=m===void 0?!0:m,A=e.maskTransitionName,O=e.maskAnimation,K=e.maskClosable,_=K===void 0?!0:K,$=e.maskStyle,T=e.maskProps,z=e.rootClassName,x=n.useRef(),S=n.useRef(),D=n.useRef(),B=n.useState(i),R=Y(B,2),U=R[0],V=R[1],ae=ue();function ne(){F(S.current,document.activeElement)||(x.current=document.activeElement)}function oe(){if(!F(S.current,document.activeElement)){var l;(l=D.current)===null||l===void 0||l.focus()}}function re(l){if(l)oe();else{if(V(!1),k&&x.current&&y){try{x.current.focus({preventScroll:!0})}catch{}x.current=null}U&&(h==null||h())}g==null||g(l)}function j(l){v==null||v(l)}var L=n.useRef(!1),H=n.useRef(),ie=function(){clearTimeout(H.current),L.current=!0},le=function(){H.current=setTimeout(function(){L.current=!1})},q=null;_&&(q=function(X){L.current?L.current=!1:S.current===X.target&&j(X)});function se(l){if(f&&l.keyCode===G.ESC){l.stopPropagation(),j(l);return}i&&l.keyCode===G.TAB&&D.current.changeActive(!l.shiftKey)}return n.useEffect(function(){i&&(V(!0),ne())},[i]),n.useEffect(function(){return function(){clearTimeout(H.current)}},[]),n.createElement("div",w({className:W("".concat(t,"-root"),z)},me(e,{data:!0})),n.createElement(ye,{prefixCls:t,visible:k&&i,motionName:J(t,A,O),style:C({zIndex:o},$),maskProps:T}),n.createElement("div",w({tabIndex:-1,onKeyDown:se,className:W("".concat(t,"-wrap"),b),ref:S,onClick:q,style:C(C({zIndex:o},N),{},{display:U?null:"none"})},d),n.createElement(te,w({},e,{onMouseDown:ie,onMouseUp:le,ref:D,closable:I,ariaId:ae,prefixCls:t,visible:i&&U,onClose:j,onVisibleChanged:re,motionName:J(t,P,M)}))))}var ge=function(a){var t=a.visible,o=a.getContainer,r=a.forceRender,i=a.destroyOnClose,c=i===void 0?!1:i,f=a.afterClose,u=a.panelRef,y=n.useState(t),N=Y(y,2),b=N[0],d=N[1],v=n.useMemo(function(){return{panel:u}},[u]);return n.useEffect(function(){t&&d(!0)},[t]),!r&&c&&!b?null:n.createElement(ee.Provider,{value:v},n.createElement(ce,{open:t||r||b,autoDestroy:!1,getContainer:o,autoLock:t||b},n.createElement(be,w({},a,{destroyOnClose:c,afterClose:function(){f==null||f(),d(!1)}}))))};ge.displayName="Dialog";export{ge as D,Ce as P};
