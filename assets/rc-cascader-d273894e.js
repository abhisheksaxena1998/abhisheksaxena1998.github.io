import{K as oe,p as Fe,f as Be}from"./rc-util-6fbd7337.js";import{f as Q,e as se,b as B,d as Xe,c as le,g as qe,h as vn}from"./@babel-43e769cc.js";import{u as Te,b as fn,B as hn}from"./rc-select-6326b7aa.js";import{r}from"./react-d998b26c.js";import{c as pn,d as Ke}from"./rc-tree-24082d90.js";import{c as $e}from"./classnames-325479d5.js";import"./react-is-e8e5dbb3.js";var _e=r.createContext(null),Se="__rc_cascader_search_mark__",mn=function(n,a,t){var l=t.label;return a.some(function(i){return String(i[l]).toLowerCase().includes(n.toLowerCase())})},gn=function(n,a,t,l){return a.map(function(i){return i[l.label]}).join(" / ")};const Cn=function(e,n,a,t,l,i){var u=l.filter,s=u===void 0?mn:u,d=l.render,c=d===void 0?gn:d,x=l.limit,h=x===void 0?50:x,k=l.sort;return r.useMemo(function(){var g=[];if(!e)return[];function p(b,v){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;b.forEach(function(L){if(!(!k&&h!==!1&&h>0&&g.length>=h)){var N=[].concat(Q(v),[L]),m=L[a.children],j=w||L.disabled;if((!m||m.length===0||i)&&s(e,N,{label:a.label})){var P;g.push(se(se({},L),{},(P={disabled:j},B(P,a.label,c(e,N,t,a)),B(P,Se,N),B(P,a.children,void 0),P)))}m&&p(L[a.children],N,j)}})}return p(n,[]),k&&g.sort(function(b,v){return k(b[Se],v[Se],e,a)}),h!==!1&&h>0?g.slice(0,h):g},[e,n,a,t,c,i,s,k,h])};var Ne="__RC_CASCADER_SPLIT__",Ge="SHOW_PARENT",Je="SHOW_CHILD";function Z(e){return e.join(Ne)}function be(e){return e.map(Z)}function bn(e){return e.split(Ne)}function Sn(e){var n=e||{},a=n.label,t=n.value,l=n.children,i=t||"value";return{label:a||"label",value:i,key:i,children:l||"children"}}function xe(e,n){var a,t;return(a=e.isLeaf)!==null&&a!==void 0?a:!((t=e[n.children])!==null&&t!==void 0&&t.length)}function kn(e){var n=e.parentElement;if(n){var a=e.offsetTop-n.offsetTop;a-n.scrollTop<0?n.scrollTo({top:a}):a+e.offsetHeight-n.scrollTop>n.offsetHeight&&n.scrollTo({top:a+e.offsetHeight-n.offsetHeight})}}function Ye(e,n){return e.map(function(a){var t;return(t=a[Se])===null||t===void 0?void 0:t.map(function(l){return l[n.value]})})}function Ue(e,n,a){var t=new Set(e),l=n();return e.filter(function(i){var u=l[i],s=u?u.parent:null,d=u?u.children:null;return u&&u.node.disabled?!0:a===Je?!(d&&d.some(function(c){return c.key&&t.has(c.key)})):!(s&&!s.node.disabled&&t.has(s.key))})}function Pe(e,n,a){for(var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n,i=[],u=function(){var c,x,h,k=e[s],g=(c=l)===null||c===void 0?void 0:c.findIndex(function(b){var v=b[a.value];return t?String(v)===String(k):v===k}),p=g!==-1?(x=l)===null||x===void 0?void 0:x[g]:null;i.push({value:(h=p==null?void 0:p[a.value])!==null&&h!==void 0?h:k,index:g,option:p}),l=p==null?void 0:p[a.children]},s=0;s<e.length;s+=1)u();return i}const yn=function(e,n,a,t,l){return r.useMemo(function(){var i=l||function(u){var s=t?u.slice(-1):u,d=" / ";return s.every(function(c){return["string","number"].includes(Xe(c))})?s.join(d):s.reduce(function(c,x,h){var k=r.isValidElement(x)?r.cloneElement(x,{key:h}):x;return h===0?[k]:[].concat(Q(c),[d,k])},[])};return e.map(function(u){var s,d,c=Pe(u,n,a),x=i(c.map(function(k){var g,p=k.option,b=k.value;return(g=p==null?void 0:p[a.label])!==null&&g!==void 0?g:b}),c.map(function(k){var g=k.option;return g})),h=Z(u);return{label:x,value:h,key:h,valueCells:u,disabled:(s=c[c.length-1])===null||s===void 0||(d=s.option)===null||d===void 0?void 0:d.disabled}})},[e,n,a,l,t])},Vn=function(e,n){var a=r.useRef({options:null,info:null}),t=r.useCallback(function(){return a.current.options!==e&&(a.current.options=e,a.current.info=pn(e,{fieldNames:n,initWrapper:function(i){return se(se({},i),{},{pathKeyEntities:{}})},processEntity:function(i,u){var s=i.nodes.map(function(d){return d[n.value]}).join(Ne);u.pathKeyEntities[s]=i,i.key=s}})),a.current.info.pathKeyEntities},[n,e]);return t},xn=function(e,n){return r.useCallback(function(a){var t=[],l=[];return a.forEach(function(i){var u=Pe(i,e,n);u.every(function(s){return s.option})?l.push(i):t.push(i)}),[l,t]},[e,n])};function Pn(e){return r.useMemo(function(){if(!e)return[!1,{}];var n={matchInputWidth:!0,limit:50};return e&&Xe(e)==="object"&&(n=se(se({},n),e)),n.limit<=0&&delete n.limit,[!0,n]},[e])}var _n=r.memo(function(e){var n=e.children;return n},function(e,n){return!n.open});function On(e){var n,a=e.prefixCls,t=e.checked,l=e.halfChecked,i=e.disabled,u=e.onClick,s=e.disableCheckbox,d=r.useContext(_e),c=d.checkable,x=typeof c!="boolean"?c:null;return r.createElement("span",{className:$e("".concat(a),(n={},B(n,"".concat(a,"-checked"),t),B(n,"".concat(a,"-indeterminate"),!t&&l),B(n,"".concat(a,"-disabled"),i||s),n)),onClick:u},x)}var ze="__cascader_fix_label__";function En(e){var n=e.prefixCls,a=e.multiple,t=e.options,l=e.activeValue,i=e.prevValuePath,u=e.onToggleOpen,s=e.onSelect,d=e.onActive,c=e.checkedSet,x=e.halfCheckedSet,h=e.loadingKeys,k=e.isSelectable,g=e.searchValue,p="".concat(n,"-menu"),b="".concat(n,"-menu-item"),v=r.useContext(_e),w=v.fieldNames,L=v.changeOnSelect,N=v.expandTrigger,m=v.expandIcon,j=v.loadingIcon,P=v.dropdownMenuColumnStyle,S=N==="hover",E=r.useMemo(function(){return t.map(function(o){var y,C=o.disabled,A=o.disableCheckbox,W=o[Se],D=(y=o[ze])!==null&&y!==void 0?y:o[w.label],R=o[w.value],X=xe(o,w),re=W?W.map(function(ie){return ie[w.value]}):[].concat(Q(i),[R]),K=Z(re),J=h.includes(K),q=c.has(K),_=x.has(K);return{disabled:C,label:D,value:R,isLeaf:X,isLoading:J,checked:q,halfChecked:_,option:o,disableCheckbox:A,fullPath:re,fullPathKey:K}})},[t,c,w,x,h,i]);return r.createElement("ul",{className:p,role:"menu"},E.map(function(o){var y,C=o.disabled,A=o.label,W=o.value,D=o.isLeaf,R=o.isLoading,X=o.checked,re=o.halfChecked,K=o.option,J=o.fullPath,q=o.fullPathKey,_=o.disableCheckbox,ie=function(){if(!(C||g)){var U=Q(J);S&&D&&U.pop(),d(U)}},de=function(){k(K)&&s(J,D)},H;return typeof K.title=="string"?H=K.title:typeof A=="string"&&(H=A),r.createElement("li",{key:q,className:$e(b,(y={},B(y,"".concat(b,"-expand"),!D),B(y,"".concat(b,"-active"),l===W||l===q),B(y,"".concat(b,"-disabled"),C),B(y,"".concat(b,"-loading"),R),y)),style:P,role:"menuitemcheckbox",title:H,"aria-checked":X,"data-path-key":q,onClick:function(){ie(),!_&&(!a||D)&&de()},onDoubleClick:function(){L&&u(!1)},onMouseEnter:function(){S&&ie()},onMouseDown:function(U){U.preventDefault()}},a&&r.createElement(On,{prefixCls:"".concat(n,"-checkbox"),checked:X,halfChecked:re,disabled:C||_,disableCheckbox:_,onClick:function(U){_||(U.stopPropagation(),de())}}),r.createElement("div",{className:"".concat(b,"-content")},A),!R&&m&&!D&&r.createElement("div",{className:"".concat(b,"-expand-icon")},m),R&&j&&r.createElement("div",{className:"".concat(b,"-loading-icon")},j))}))}const wn=function(){var e=Te(),n=e.multiple,a=e.open,t=r.useContext(_e),l=t.values,i=r.useState([]),u=le(i,2),s=u[0],d=u[1];return r.useEffect(function(){if(a&&!n){var c=l[0];d(c||[])}},[a]),[s,d]},Mn=function(e,n,a,t,l,i){var u=Te(),s=u.direction,d=u.searchValue,c=u.toggleOpen,x=u.open,h=s==="rtl",k=r.useMemo(function(){for(var P=-1,S=n,E=[],o=[],y=t.length,C=Ye(n,a),A=function(K){var J=S.findIndex(function(q,_){return(C[_]?Z(C[_]):q[a.value])===t[K]});if(J===-1)return"break";P=J,E.push(P),o.push(t[K]),S=S[P][a.children]},W=0;W<y&&S;W+=1){var D=A(W);if(D==="break")break}for(var R=n,X=0;X<E.length-1;X+=1)R=R[E[X]][a.children];return[o,P,R,C]},[t,a,n]),g=le(k,4),p=g[0],b=g[1],v=g[2],w=g[3],L=function(S){l(S)},N=function(S){var E=v.length,o=b;o===-1&&S<0&&(o=E);for(var y=0;y<E;y+=1){o=(o+S+E)%E;var C=v[o];if(C&&!C.disabled){var A=p.slice(0,-1).concat(w[o]?Z(w[o]):C[a.value]);L(A);return}}},m=function(){if(p.length>1){var S=p.slice(0,-1);L(S)}else c(!1)},j=function(){var S,E=((S=v[b])===null||S===void 0?void 0:S[a.children])||[],o=E.find(function(C){return!C.disabled});if(o){var y=[].concat(Q(p),[o[a.value]]);L(y)}};r.useImperativeHandle(e,function(){return{onKeyDown:function(S){var E=S.which;switch(E){case oe.UP:case oe.DOWN:{var o=0;E===oe.UP?o=-1:E===oe.DOWN&&(o=1),o!==0&&N(o);break}case oe.LEFT:{if(d)break;h?j():m();break}case oe.RIGHT:{if(d)break;h?m():j();break}case oe.BACKSPACE:{d||m();break}case oe.ENTER:{if(p.length){var y=v[b],C=(y==null?void 0:y[Se])||[];C.length?i(C.map(function(A){return A[a.value]}),C[C.length-1]):i(p,v[b])}break}case oe.ESC:c(!1),x&&S.stopPropagation()}},onKeyUp:function(){}}})};var In=r.forwardRef(function(e,n){var a,t,l,i,u=Te(),s=u.prefixCls,d=u.multiple,c=u.searchValue,x=u.toggleOpen,h=u.notFoundContent,k=u.direction,g=u.open,p=r.useRef(),b=k==="rtl",v=r.useContext(_e),w=v.options,L=v.values,N=v.halfValues,m=v.fieldNames,j=v.changeOnSelect,P=v.onSelect,S=v.searchOptions,E=v.dropdownPrefixCls,o=v.loadData,y=v.expandTrigger,C=E||s,A=r.useState([]),W=le(A,2),D=W[0],R=W[1],X=function(f){if(!(!o||c)){var O=Pe(f,w,m),I=O.map(function(pe){var me=pe.option;return me}),F=I[I.length-1];if(F&&!xe(F,m)){var ae=Z(f);R(function(pe){return[].concat(Q(pe),[ae])}),o(I)}}};r.useEffect(function(){D.length&&D.forEach(function(M){var f=bn(M),O=Pe(f,w,m,!0).map(function(F){var ae=F.option;return ae}),I=O[O.length-1];(!I||I[m.children]||xe(I,m))&&R(function(F){return F.filter(function(ae){return ae!==M})})})},[w,D,m]);var re=r.useMemo(function(){return new Set(be(L))},[L]),K=r.useMemo(function(){return new Set(be(N))},[N]),J=wn(),q=le(J,2),_=q[0],ie=q[1],de=function(f){ie(f),X(f)},H=function(f){var O=f.disabled,I=xe(f,m);return!O&&(I||j||d)},Y=function(f,O){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;P(f),!d&&(O||j&&(y==="hover"||I))&&x(!1)},U=r.useMemo(function(){return c?S:w},[c,S,w]),he=r.useMemo(function(){for(var M=[{options:U}],f=U,O=Ye(f,m),I=function(){var me=_[F],ve=f.find(function(Ie,ge){return(O[ge]?Z(O[ge]):Ie[m.value])===me}),ce=ve==null?void 0:ve[m.children];if(!(ce!=null&&ce.length))return"break";f=ce,M.push({options:ce})},F=0;F<_.length;F+=1){var ae=I();if(ae==="break")break}return M},[U,_,m]),we=function(f,O){H(O)&&Y(f,xe(O,m),!0)};Mn(n,U,m,_,de,we),r.useEffect(function(){for(var M=0;M<_.length;M+=1){var f,O=_.slice(0,M+1),I=Z(O),F=(f=p.current)===null||f===void 0?void 0:f.querySelector('li[data-path-key="'.concat(I.replace(/\\{0,2}"/g,'\\"'),'"]'));F&&kn(F)}},[_]);var G=!((a=he[0])!==null&&a!==void 0&&(t=a.options)!==null&&t!==void 0&&t.length),ee=[(l={},B(l,m.value,"__EMPTY__"),B(l,ze,h),B(l,"disabled",!0),l)],ne=se(se({},e),{},{multiple:!G&&d,onSelect:Y,onActive:de,onToggleOpen:x,checkedSet:re,halfCheckedSet:K,loadingKeys:D,isSelectable:H}),ue=G?[{options:ee}]:he,Me=ue.map(function(M,f){var O=_.slice(0,f),I=_[f];return r.createElement(En,qe({key:f},ne,{searchValue:c,prefixCls:C,options:M.options,prevValuePath:O,activeValue:I}))});return r.createElement(_n,{open:g},r.createElement("div",{className:$e("".concat(C,"-menus"),(i={},B(i,"".concat(C,"-menu-empty"),G),B(i,"".concat(C,"-rtl"),b),i)),ref:p},Me))}),Ln=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","autoClearSearchValue","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy"];function An(e){return Array.isArray(e)&&Array.isArray(e[0])}function je(e){return e?An(e)?e:(e.length===0?[]:[e]).map(function(n){return Array.isArray(n)?n:[n]}):[]}var Qe=r.forwardRef(function(e,n){var a=e.id,t=e.prefixCls,l=t===void 0?"rc-cascader":t,i=e.fieldNames,u=e.defaultValue,s=e.value,d=e.changeOnSelect,c=e.onChange,x=e.displayRender,h=e.checkable,k=e.autoClearSearchValue,g=k===void 0?!0:k,p=e.searchValue,b=e.onSearch,v=e.showSearch,w=e.expandTrigger,L=e.options,N=e.dropdownPrefixCls,m=e.loadData,j=e.popupVisible,P=e.open,S=e.popupClassName,E=e.dropdownClassName,o=e.dropdownMenuColumnStyle,y=e.popupPlacement,C=e.placement,A=e.onDropdownVisibleChange,W=e.onPopupVisibleChange,D=e.expandIcon,R=D===void 0?">":D,X=e.loadingIcon,re=e.children,K=e.dropdownMatchSelectWidth,J=K===void 0?!1:K,q=e.showCheckedStrategy,_=q===void 0?Ge:q,ie=vn(e,Ln),de=fn(a),H=!!h,Y=Fe(u,{value:s,postState:je}),U=le(Y,2),he=U[0],we=U[1],G=r.useMemo(function(){return Sn(i)},[JSON.stringify(i)]),ee=r.useMemo(function(){return L||[]},[L]),ne=Vn(ee,G),ue=r.useCallback(function(T){var V=ne();return T.map(function($){var te=V[$].nodes;return te.map(function(z){return z[G.value]})})},[ne,G]),Me=Fe("",{value:p,postState:function(V){return V||""}}),M=le(Me,2),f=M[0],O=M[1],I=function(V,$){O(V),$.source!=="blur"&&b&&b(V)},F=Pn(v),ae=le(F,2),pe=ae[0],me=ae[1],ve=Cn(f,ee,G,N||l,me,d),ce=xn(ee,G),Ie=r.useMemo(function(){var T=ce(he),V=le(T,2),$=V[0],te=V[1];if(!H||!he.length)return[$,[],te];var z=be($),ye=ne(),fe=Ke(z,!0,ye),Oe=fe.checkedKeys,Ee=fe.halfCheckedKeys;return[ue(Oe),ue(Ee),te]},[H,he,ne,ue,ce]),ge=le(Ie,3),Ce=ge[0],Le=ge[1],ke=ge[2],Ze=r.useMemo(function(){var T=be(Ce),V=Ue(T,ne,_);return[].concat(Q(ke),Q(ue(V)))},[Ce,ne,ue,ke,_]),en=yn(Ze,ee,G,H,x),Ae=Be(function(T){if(we(T),c){var V=je(T),$=V.map(function(ye){return Pe(ye,ee,G).map(function(fe){return fe.option})}),te=H?V:V[0],z=H?$:$[0];c(te,z)}}),De=Be(function(T){if((!H||g)&&O(""),!H)Ae(T);else{var V=Z(T),$=be(Ce),te=be(Le),z=$.includes(V),ye=ke.some(function(Ve){return Z(Ve)===V}),fe=Ce,Oe=ke;if(ye&&!z)Oe=ke.filter(function(Ve){return Z(Ve)!==V});else{var Ee=z?$.filter(function(Ve){return Ve!==V}):[].concat(Q($),[V]),He=ne(),Re;if(z){var cn=Ke(Ee,{checked:!1,halfCheckedKeys:te},He);Re=cn.checkedKeys}else{var sn=Ke(Ee,!0,He);Re=sn.checkedKeys}var dn=Ue(Re,ne,_);fe=ue(dn)}Ae([].concat(Q(Oe),Q(fe)))}}),nn=function(V,$){if($.type==="clear"){Ae([]);return}var te=$.values[0],z=te.valueCells;De(z)},an=P!==void 0?P:j,tn=E||S,rn=C||y,on=function(V){A==null||A(V),W==null||W(V)},ln=r.useMemo(function(){return{options:ee,fieldNames:G,values:Ce,halfValues:Le,changeOnSelect:d,onSelect:De,checkable:h,searchOptions:ve,dropdownPrefixCls:N,loadData:m,expandTrigger:w,expandIcon:R,loadingIcon:X,dropdownMenuColumnStyle:o}},[ee,G,Ce,Le,d,De,h,ve,N,m,w,R,X,o]),We=!(f?ve:ee).length,un=f&&me.matchInputWidth||We?{}:{minWidth:"auto"};return r.createElement(_e.Provider,{value:ln},r.createElement(hn,qe({},ie,{ref:n,id:de,prefixCls:l,autoClearSearchValue:g,dropdownMatchSelectWidth:J,dropdownStyle:un,displayValues:en,onDisplayValuesChange:nn,mode:H?"multiple":void 0,searchValue:f,onSearch:I,showSearch:pe,OptionList:In,emptyOptions:We,open:an,dropdownClassName:tn,placement:rn,onDropdownVisibleChange:on,getRawInputElement:function(){return re}})))});Qe.SHOW_PARENT=Ge;Qe.SHOW_CHILD=Je;export{Qe as C};
