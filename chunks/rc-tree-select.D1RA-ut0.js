import{A as _r,b as We,t as Vr,K as ue,e as cr}from"./rc-util.9PQy9ck0.js";import{e as L,f as B,k as vr,b as Mr,c as G,g as hr,d as Nr}from"./@babel.CqxtU2kl.js";import{u as Pr,b as Or,B as Ar}from"./rc-select.Dllk844I.js";import{r as t}from"./react.DPZx3FLm.js";import{a as ze,c as Hr,T as Rr}from"./rc-tree.BxqKADDF.js";import"./classnames.CIPFGIzL.js";import"./rc-overflow.I4o3U_CK.js";import"./react-dom.stFbKHXB.js";import"./rc-resize-observer.XqflEGEn.js";import"./rc-motion.cq0Hvde5.js";const $r=function(e){var r=t.useRef({valueLabels:new Map});return t.useMemo(function(){var n=r.current.valueLabels,o=new Map,l=e.map(function(u){var a,c=u.value,i=(a=u.label)!==null&&a!==void 0?a:n.get(c);return o.set(c,i),L(L({},u),{},{label:i})});return r.current.valueLabels=o,[l]},[e])},Fr=function(e,r,n,o){return t.useMemo(function(){var l=e.map(function(i){var f=i.value;return f}),u=r.map(function(i){var f=i.value;return f}),a=l.filter(function(i){return!o[i]});if(n){var c=ze(l,!0,o);l=c.checkedKeys,u=c.halfCheckedKeys}return[Array.from(new Set([].concat(B(a),B(l)))),u]},[e,r,n,o])};function Wr(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function jr(e){var r=e||{},n=r.label,o=r.value,l=r.children,u=o||"value";return{_title:n?[n]:["title","label"],value:u,key:u,children:l||"children"}}function Qe(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function Ur(e,r){var n=[];function o(l){l.forEach(function(u){var a=u[r.children];a&&(n.push(u[r.value]),o(a))})}return o(e),n}function dr(e){return e==null}const Br=function(e,r){return t.useMemo(function(){var n=Hr(e,{fieldNames:r,initWrapper:function(l){return L(L({},l),{},{valueEntities:new Map})},processEntity:function(l,u){var a=l.node[r.value];u.valueEntities.set(a,l)}});return n},[e,r])};var pr=function(){return null},Gr=["children","value"];function mr(e){return _r(e).map(function(r){if(!t.isValidElement(r)||!r.type)return null;var n=r,o=n.key,l=n.props,u=l.children,a=l.value,c=vr(l,Gr),i=L({key:o,value:a},c),f=mr(u);return f.length&&(i.children=f),i}).filter(function(r){return r})}function Xe(e){if(!e)return e;var r=L({},e);return"props"in r||Object.defineProperty(r,"props",{get:function(){return We(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),r}}),r}function Jr(e,r,n,o,l,u){var a=null,c=null;function i(){function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(C,O){var x="".concat(I,"-").concat(O),K=C[u.value],R=n.includes(K),J=f(C[u.children]||[],x,R),$=t.createElement(pr,C,J.map(function(F){return F.node}));if(r===K&&(a=$),R){var Z={pos:x,node:$,children:J};return E||c.push(Z),Z}return null}).filter(function(C){return C})}c||(c=[],f(o),c.sort(function(d,I){var E=d.node.props.value,C=I.node.props.value,O=n.indexOf(E),x=n.indexOf(C);return O-x}))}Object.defineProperty(e,"triggerNode",{get:function(){return We(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),i(),a}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return We(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),i(),l?c:c.map(function(d){var I=d.node;return I})}})}const Yr=function(e,r,n){var o=n.treeNodeFilterProp,l=n.filterTreeNode,u=n.fieldNames,a=u.children;return t.useMemo(function(){if(!r||l===!1)return e;var c;if(typeof l=="function")c=l;else{var i=r.toUpperCase();c=function(I,E){var C=E[o];return String(C).toUpperCase().includes(i)}}function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.reduce(function(E,C){var O=C[a],x=I||c(r,Xe(C)),K=f(O||[],x);return(x||K.length)&&E.push(L(L({},C),{},Mr({isLeaf:void 0},a,K))),E},[])}return f(e)},[e,r,a,o,l])};function sr(e){var r=t.useRef();r.current=e;var n=t.useCallback(function(){return r.current.apply(r,arguments)},[]);return n}function qr(e,r){var n=r.id,o=r.pId,l=r.rootPId,u={},a=[],c=e.map(function(i){var f=L({},i),d=f[n];return u[d]=f,f.key=f.key||d,f});return c.forEach(function(i){var f=i[o],d=u[f];d&&(d.children=d.children||[],d.children.push(i)),(f===l||!d&&l===null)&&a.push(i)}),a}function zr(e,r,n){return t.useMemo(function(){return e?n?qr(e,L({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:mr(r)},[r,n,e])}var gr=t.createContext(null),yr=t.createContext(null),Qr={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Xr=function(r,n){var o=Pr(),l=o.prefixCls,u=o.multiple,a=o.searchValue,c=o.toggleOpen,i=o.open,f=o.notFoundContent,d=t.useContext(yr),I=d.virtual,E=d.listHeight,C=d.listItemHeight,O=d.listItemScrollOffset,x=d.treeData,K=d.fieldNames,R=d.onSelect,J=d.dropdownMatchSelectWidth,$=d.treeExpandAction,Z=d.treeTitleRender,F=d.onPopupScroll,S=t.useContext(gr),W=S.checkable,_=S.checkedKeys,ke=S.halfCheckedKeys,ce=S.treeExpandedKeys,Ue=S.treeDefaultExpandAll,Ee=S.treeDefaultExpandedKeys,de=S.onTreeExpand,xe=S.treeIcon,De=S.showTreeIcon,we=S.switcherIcon,Ie=S.treeLine,Te=S.treeNodeFilterProp,Le=S.loadData,se=S.treeLoadedKeys,Ke=S.treeMotion,_e=S.onTreeLoad,Ve=S.keyEntities,Y=t.useRef(),fe=Vr(function(){return x},[i,x],function(b,h){return h[0]&&b[1]!==h[1]}),Me=t.useState(null),ee=G(Me,2),re=ee[0],te=ee[1],A=Ve[re],Ne=t.useMemo(function(){return W?{checked:_,halfChecked:ke}:null},[W,_,ke]);t.useEffect(function(){if(i&&!u&&_.length){var b;(b=Y.current)===null||b===void 0||b.scrollTo({key:_[0]}),te(_[0])}},[i]);var ve=String(a).toLowerCase(),Pe=function(h){return ve?String(h[Te]).toLowerCase().includes(ve):!1},Oe=t.useState(Ee),V=G(Oe,2),he=V[0],Be=V[1],Ge=t.useState(null),q=G(Ge,2),z=q[0],pe=q[1],M=t.useMemo(function(){return ce?B(ce):a?z:he},[he,z,ce,a]);t.useEffect(function(){a&&pe(Ur(x,K))},[a]);var Je=function(h){Be(h),pe(h),de&&de(h)},me=function(h){h.preventDefault()},H=function(h,ne){var N=ne.node;W&&Qe(N)||(R(N.key,{selected:!_.includes(N.key)}),u||c(!1))};if(t.useImperativeHandle(n,function(){var b;return{scrollTo:(b=Y.current)===null||b===void 0?void 0:b.scrollTo,onKeyDown:function(ne){var N,Ae=ne.which;switch(Ae){case ue.UP:case ue.DOWN:case ue.LEFT:case ue.RIGHT:(N=Y.current)===null||N===void 0||N.onKeyDown(ne);break;case ue.ENTER:{if(A){var ye=(A==null?void 0:A.node)||{},Ye=ye.selectable,ae=ye.value;Ye!==!1&&H(null,{node:{key:re},selected:!_.includes(ae)})}break}case ue.ESC:c(!1)}},onKeyUp:function(){}}}),fe.length===0)return t.createElement("div",{role:"listbox",className:"".concat(l,"-empty"),onMouseDown:me},f);var ge={fieldNames:K};return se&&(ge.loadedKeys=se),M&&(ge.expandedKeys=M),t.createElement("div",{onMouseDown:me},A&&i&&t.createElement("span",{style:Qr,"aria-live":"assertive"},A.node.value),t.createElement(Rr,hr({ref:Y,focusable:!1,prefixCls:"".concat(l,"-tree"),treeData:fe,height:E,itemHeight:C,itemScrollOffset:O,virtual:I!==!1&&J!==!1,multiple:u,icon:xe,showIcon:De,switcherIcon:we,showLine:Ie,loadData:a?null:Le,motion:Ke,activeKey:re,checkable:W,checkStrictly:!0,checkedKeys:Ne,selectedKeys:W?[]:_,defaultExpandAll:Ue,titleRender:Z},ge,{onActiveChange:te,onSelect:H,onCheck:H,onExpand:Je,onLoad:_e,filterTreeNode:Pe,expandAction:$,onScroll:F})))},Zr=t.forwardRef(Xr),Sr="SHOW_ALL",Cr="SHOW_PARENT",Ze="SHOW_CHILD";function fr(e,r,n,o){var l=new Set(e);return r===Ze?e.filter(function(u){var a=n[u];return!(a&&a.children&&a.children.some(function(c){var i=c.node;return l.has(i[o.value])})&&a.children.every(function(c){var i=c.node;return Qe(i)||l.has(i[o.value])}))}):r===Cr?e.filter(function(u){var a=n[u],c=a?a.parent:null;return!(c&&!Qe(c.node)&&l.has(c.key))}):e}var et=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender","onPopupScroll"];function rt(e){return!e||Nr(e)!=="object"}var tt=t.forwardRef(function(e,r){var n=e.id,o=e.prefixCls,l=o===void 0?"rc-tree-select":o,u=e.value,a=e.defaultValue,c=e.onChange,i=e.onSelect,f=e.onDeselect,d=e.searchValue,I=e.inputValue,E=e.onSearch,C=e.autoClearSearchValue,O=C===void 0?!0:C,x=e.filterTreeNode,K=e.treeNodeFilterProp,R=K===void 0?"value":K,J=e.showCheckedStrategy,$=e.treeNodeLabelProp,Z=e.multiple,F=e.treeCheckable,S=e.treeCheckStrictly,W=e.labelInValue,_=e.fieldNames,ke=e.treeDataSimpleMode,ce=e.treeData,Ue=e.children,Ee=e.loadData,de=e.treeLoadedKeys,xe=e.onTreeLoad,De=e.treeDefaultExpandAll,we=e.treeExpandedKeys,Ie=e.treeDefaultExpandedKeys,Te=e.onTreeExpand,Le=e.treeExpandAction,se=e.virtual,Ke=e.listHeight,_e=Ke===void 0?200:Ke,Ve=e.listItemHeight,Y=Ve===void 0?20:Ve,fe=e.listItemScrollOffset,Me=fe===void 0?0:fe,ee=e.onDropdownVisibleChange,re=e.dropdownMatchSelectWidth,te=re===void 0?!0:re,A=e.treeLine,Ne=e.treeIcon,ve=e.showTreeIcon,Pe=e.switcherIcon,Oe=e.treeMotion,V=e.treeTitleRender,he=e.onPopupScroll,Be=vr(e,et),Ge=Or(n),q=F&&!S,z=F||S,pe=S||W,M=z||Z,Je=cr(a,{value:u}),me=G(Je,2),H=me[0],ge=me[1],b=t.useMemo(function(){return F?J||Ze:Sr},[J,F]),h=t.useMemo(function(){return jr(_)},[JSON.stringify(_)]),ne=cr("",{value:d!==void 0?d:I,postState:function(s){return s||""}}),N=G(ne,2),Ae=N[0],ye=N[1],Ye=function(s){ye(s),E==null||E(s)},ae=zr(ce,Ue,ke),er=Br(ae,h),T=er.keyEntities,Q=er.valueEntities,rr=t.useCallback(function(v){var s=[],p=[];return v.forEach(function(m){Q.has(m)?p.push(m):s.push(m)}),{missingRawValues:s,existRawValues:p}},[Q]),tr=Yr(ae,Ae,{fieldNames:h,treeNodeFilterProp:R,filterTreeNode:x}),nr=t.useCallback(function(v){if(v){if($)return v[$];for(var s=h._title,p=0;p<s.length;p+=1){var m=v[s[p]];if(m!==void 0)return m}}},[h,$]),Se=t.useCallback(function(v){var s=Wr(v);return s.map(function(p){return rt(p)?{value:p}:p})},[]),He=t.useCallback(function(v){var s=Se(v);return s.map(function(p){var m=p.label,D=p.value,k=p.halfChecked,g,y=Q.get(D);if(y){var w;m=V?V(y.node):(w=m)!==null&&w!==void 0?w:nr(y.node),g=y.node.disabled}else if(m===void 0){var j=Se(H).find(function(Ce){return Ce.value===D});m=j.label}return{label:m,value:D,halfChecked:k,disabled:g}})},[Q,nr,Se,H]),ar=t.useMemo(function(){return Se(H===null?[]:H)},[Se,H]),br=t.useMemo(function(){var v=[],s=[];return ar.forEach(function(p){p.halfChecked?s.push(p):v.push(p)}),[v,s]},[ar]),lr=G(br,2),le=lr[0],ir=lr[1],or=t.useMemo(function(){return le.map(function(v){return v.value})},[le]),kr=Fr(le,ir,q,T),ur=G(kr,2),ie=ur[0],Re=ur[1],Er=t.useMemo(function(){var v=fr(ie,b,T,h),s=v.map(function(k){var g,y;return(g=(y=T[k])===null||y===void 0||(y=y.node)===null||y===void 0?void 0:y[h.value])!==null&&g!==void 0?g:k}),p=s.map(function(k){var g=le.find(function(w){return w.value===k}),y=W?g==null?void 0:g.label:V==null?void 0:V(g);return{value:k,label:y}}),m=He(p),D=m[0];return!M&&D&&dr(D.value)&&dr(D.label)?[]:m.map(function(k){var g;return L(L({},k),{},{label:(g=k.label)!==null&&g!==void 0?g:k.value})})},[h,M,ie,le,He,b,T]),xr=$r(Er),Dr=G(xr,1),wr=Dr[0],$e=sr(function(v,s,p){var m=He(v);if(ge(m),O&&ye(""),c){var D=v;if(q){var k=fr(v,b,T,h);D=k.map(function(P){var U=Q.get(P);return U?U.node[h.value]:P})}var g=s||{triggerValue:void 0,selected:void 0},y=g.triggerValue,w=g.selected,j=D;if(S){var Ce=ir.filter(function(P){return!D.includes(P.value)});j=[].concat(B(j),B(Ce))}var be=He(j),X={preValue:le,triggerValue:y},oe=!0;(S||p==="selection"&&!w)&&(oe=!1),Jr(X,y,v,ae,oe,h),z?X.checked=w:X.selected=w;var Fe=pe?be:be.map(function(P){return P.value});c(M?Fe:Fe[0],pe?null:be.map(function(P){return P.label}),X)}}),qe=t.useCallback(function(v,s){var p,m=s.selected,D=s.source,k=T[v],g=k==null?void 0:k.node,y=(p=g==null?void 0:g[h.value])!==null&&p!==void 0?p:v;if(!M)$e([y],{selected:!0,triggerValue:y},"option");else{var w=m?[].concat(B(or),[y]):ie.filter(function(U){return U!==y});if(q){var j=rr(w),Ce=j.missingRawValues,be=j.existRawValues,X=be.map(function(U){return Q.get(U).key}),oe;if(m){var Fe=ze(X,!0,T);oe=Fe.checkedKeys}else{var P=ze(X,{checked:!1,halfCheckedKeys:Re},T);oe=P.checkedKeys}w=[].concat(B(Ce),B(oe.map(function(U){return T[U].node[h.value]})))}$e(w,{selected:m,triggerValue:y},D||"option")}m||!M?i==null||i(y,Xe(g)):f==null||f(y,Xe(g))},[rr,Q,T,h,M,or,$e,q,i,f,ie,Re]),Ir=t.useCallback(function(v){if(ee){var s={};Object.defineProperty(s,"documentClickClose",{get:function(){return We(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),ee(v,s)}},[ee]),Tr=sr(function(v,s){var p=v.map(function(m){return m.value});if(s.type==="clear"){$e(p,{},"selection");return}s.values.length&&qe(s.values[0].value,{selected:!1,source:"selection"})}),Lr=t.useMemo(function(){return{virtual:se,dropdownMatchSelectWidth:te,listHeight:_e,listItemHeight:Y,listItemScrollOffset:Me,treeData:tr,fieldNames:h,onSelect:qe,treeExpandAction:Le,treeTitleRender:V,onPopupScroll:he}},[se,te,_e,Y,Me,tr,h,qe,Le,V,he]),Kr=t.useMemo(function(){return{checkable:z,loadData:Ee,treeLoadedKeys:de,onTreeLoad:xe,checkedKeys:ie,halfCheckedKeys:Re,treeDefaultExpandAll:De,treeExpandedKeys:we,treeDefaultExpandedKeys:Ie,onTreeExpand:Te,treeIcon:Ne,treeMotion:Oe,showTreeIcon:ve,switcherIcon:Pe,treeLine:A,treeNodeFilterProp:R,keyEntities:T}},[z,Ee,de,xe,ie,Re,De,we,Ie,Te,Ne,Oe,ve,Pe,A,R,T]);return t.createElement(yr.Provider,{value:Lr},t.createElement(gr.Provider,{value:Kr},t.createElement(Ar,hr({ref:r},Be,{id:Ge,prefixCls:l,mode:M?"multiple":void 0,displayValues:wr,onDisplayValuesChange:Tr,searchValue:Ae,onSearch:Ye,OptionList:Zr,emptyOptions:!ae.length,onDropdownVisibleChange:Ir,dropdownMatchSelectWidth:te}))))}),je=tt;je.TreeNode=pr;je.SHOW_ALL=Sr;je.SHOW_PARENT=Cr;je.SHOW_CHILD=Ze;export{je as G,Sr as S,pr as T,Cr as a,Ze as b};
