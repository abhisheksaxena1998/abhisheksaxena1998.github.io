import{e as d,d as p,g as I,c as Q}from"./@babel.CqxtU2kl.js";import{P as ve}from"./@rc-component.icrtlwR4.js";import{r as n,a as f}from"./react.DPZx3FLm.js";import{c as k}from"./classnames.CIPFGIzL.js";import{h as Ce,p as oe,n as ye,F as ee,K as te}from"./rc-util.9PQy9ck0.js";import{C as le}from"./rc-motion.cq0Hvde5.js";var re=n.createContext({});function ae(t,e,a){var o=e;return!o&&a&&(o="".concat(t,"-").concat(a)),o}function ne(t,e){var a=t["page".concat(e?"Y":"X","Offset")],o="scroll".concat(e?"Top":"Left");if(typeof a!="number"){var r=t.document;a=r.documentElement[o],typeof a!="number"&&(a=r.body[o])}return a}function be(t){var e=t.getBoundingClientRect(),a={left:e.left,top:e.top},o=t.ownerDocument,r=o.defaultView||o.parentWindow;return a.left+=ne(r),a.top+=ne(r,!0),a}const Ne=n.memo(function(t){var e=t.children;return e},function(t,e){var a=e.shouldUpdate;return!a});var ge={width:0,height:0,overflow:"hidden",outline:"none"},Re={outline:"none"},he=f.forwardRef(function(t,e){var a=t.prefixCls,o=t.className,r=t.style,m=t.title,c=t.ariaId,v=t.footer,l=t.closable,C=t.closeIcon,N=t.onClose,b=t.children,y=t.bodyStyle,E=t.bodyProps,R=t.modalRender,S=t.onMouseDown,x=t.onMouseUp,T=t.holderRef,O=t.visible,_=t.forceRender,g=t.width,D=t.height,i=t.classNames,u=t.styles,F=f.useContext(re),L=F.panel,H=Ce(T,L),A=n.useRef(),V=n.useRef();f.useImperativeHandle(e,function(){return{focus:function(){var h;(h=A.current)===null||h===void 0||h.focus({preventScroll:!0})},changeActive:function(h){var Y=document,B=Y.activeElement;h&&B===V.current?A.current.focus({preventScroll:!0}):!h&&B===A.current&&V.current.focus({preventScroll:!0})}}});var U={};g!==void 0&&(U.width=g),D!==void 0&&(U.height=D);var w=v?f.createElement("div",{className:k("".concat(a,"-footer"),i==null?void 0:i.footer),style:d({},u==null?void 0:u.footer)},v):null,P=m?f.createElement("div",{className:k("".concat(a,"-header"),i==null?void 0:i.header),style:d({},u==null?void 0:u.header)},f.createElement("div",{className:"".concat(a,"-title"),id:c},m)):null,M=n.useMemo(function(){return p(l)==="object"&&l!==null?l:l?{closeIcon:C??f.createElement("span",{className:"".concat(a,"-close-x")})}:{}},[l,C,a]),$=oe(M,!0),W=p(l)==="object"&&l.disabled,X=l?f.createElement("button",I({type:"button",onClick:N,"aria-label":"Close"},$,{className:"".concat(a,"-close"),disabled:W}),M.closeIcon):null,K=f.createElement("div",{className:k("".concat(a,"-content"),i==null?void 0:i.content),style:u==null?void 0:u.content},X,P,f.createElement("div",I({className:k("".concat(a,"-body"),i==null?void 0:i.body),style:d(d({},y),u==null?void 0:u.body)},E),b),w);return f.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":m?c:null,"aria-modal":"true",ref:H,style:d(d({},r),U),className:k(a,o),onMouseDown:S,onMouseUp:x},f.createElement("div",{ref:A,tabIndex:0,style:Re},f.createElement(Ne,{shouldUpdate:O||_},R?R(K):K)),f.createElement("div",{tabIndex:0,ref:V,style:ge}))}),ie=n.forwardRef(function(t,e){var a=t.prefixCls,o=t.title,r=t.style,m=t.className,c=t.visible,v=t.forceRender,l=t.destroyOnClose,C=t.motionName,N=t.ariaId,b=t.onVisibleChanged,y=t.mousePosition,E=n.useRef(),R=n.useState(),S=Q(R,2),x=S[0],T=S[1],O={};x&&(O.transformOrigin=x);function _(){var g=be(E.current);T(y&&(y.x||y.y)?"".concat(y.x-g.left,"px ").concat(y.y-g.top,"px"):"")}return n.createElement(le,{visible:c,onVisibleChanged:b,onAppearPrepare:_,onEnterPrepare:_,forceRender:v,motionName:C,removeOnLeave:l,ref:E},function(g,D){var i=g.className,u=g.style;return n.createElement(he,I({},t,{ref:e,title:o,ariaId:N,prefixCls:a,holderRef:D,style:d(d(d({},u),r),O),className:k(m,i)}))})});ie.displayName="Content";var ke=function(e){var a=e.prefixCls,o=e.style,r=e.visible,m=e.maskProps,c=e.motionName,v=e.className;return n.createElement(le,{key:"mask",visible:r,motionName:c,leavedClassName:"".concat(a,"-mask-hidden")},function(l,C){var N=l.className,b=l.style;return n.createElement("div",I({ref:C,style:d(d({},b),o),className:k("".concat(a,"-mask"),N,v)},m))})},Ee=function(e){var a=e.prefixCls,o=a===void 0?"rc-dialog":a,r=e.zIndex,m=e.visible,c=m===void 0?!1:m,v=e.keyboard,l=v===void 0?!0:v,C=e.focusTriggerAfterClose,N=C===void 0?!0:C,b=e.wrapStyle,y=e.wrapClassName,E=e.wrapProps,R=e.onClose,S=e.afterOpenChange,x=e.afterClose,T=e.transitionName,O=e.animation,_=e.closable,g=_===void 0?!0:_,D=e.mask,i=D===void 0?!0:D,u=e.maskTransitionName,F=e.maskAnimation,L=e.maskClosable,H=L===void 0?!0:L,A=e.maskStyle,V=e.maskProps,U=e.rootClassName,w=e.classNames,P=e.styles,M=n.useRef(),$=n.useRef(),W=n.useRef(),X=n.useState(c),K=Q(X,2),j=K[0],h=K[1],Y=ye();function B(){ee($.current,document.activeElement)||(M.current=document.activeElement)}function se(){if(!ee($.current,document.activeElement)){var s;(s=W.current)===null||s===void 0||s.focus()}}function ce(s){if(s)se();else{if(h(!1),i&&M.current&&N){try{M.current.focus({preventScroll:!0})}catch{}M.current=null}j&&(x==null||x())}S==null||S(s)}function q(s){R==null||R(s)}var z=n.useRef(!1),G=n.useRef(),ue=function(){clearTimeout(G.current),z.current=!0},de=function(){G.current=setTimeout(function(){z.current=!1})},Z=null;H&&(Z=function(J){z.current?z.current=!1:$.current===J.target&&q(J)});function fe(s){if(l&&s.keyCode===te.ESC){s.stopPropagation(),q(s);return}c&&s.keyCode===te.TAB&&W.current.changeActive(!s.shiftKey)}n.useEffect(function(){c&&(h(!0),B())},[c]),n.useEffect(function(){return function(){clearTimeout(G.current)}},[]);var me=d(d(d({zIndex:r},b),P==null?void 0:P.wrapper),{},{display:j?null:"none"});return n.createElement("div",I({className:k("".concat(o,"-root"),U)},oe(e,{data:!0})),n.createElement(ke,{prefixCls:o,visible:i&&c,motionName:ae(o,u,F),style:d(d({zIndex:r},A),P==null?void 0:P.mask),maskProps:V,className:w==null?void 0:w.mask}),n.createElement("div",I({tabIndex:-1,onKeyDown:fe,className:k("".concat(o,"-wrap"),y,w==null?void 0:w.wrapper),ref:$,onClick:Z,style:me},E),n.createElement(ie,I({},e,{onMouseDown:ue,onMouseUp:de,ref:W,closable:g,ariaId:Y,prefixCls:o,visible:c&&j,onClose:q,onVisibleChanged:ce,motionName:ae(o,T,O)}))))},Se=function(e){var a=e.visible,o=e.getContainer,r=e.forceRender,m=e.destroyOnClose,c=m===void 0?!1:m,v=e.afterClose,l=e.panelRef,C=n.useState(a),N=Q(C,2),b=N[0],y=N[1],E=n.useMemo(function(){return{panel:l}},[l]);return n.useEffect(function(){a&&y(!0)},[a]),!r&&c&&!b?null:n.createElement(re.Provider,{value:E},n.createElement(ve,{open:a||r||b,autoDestroy:!1,getContainer:o,autoLock:a||b},n.createElement(Ee,I({},e,{destroyOnClose:c,afterClose:function(){v==null||v(),y(!1)}}))))};Se.displayName="Dialog";export{Se as D,he as P};
