import{A as Tt,b as Re,q as Vt,K as le,p as ut}from"./rc-util-cfa393e8.js";import{e as T,f as j,h as st,b as _t,c as U,g as ft,d as Nt}from"./@babel-28107d12.js";import{u as Mt,b as Ot,B as Pt}from"./rc-select-6c7d5781.js";import{r}from"./react-d998b26c.js";import{a as Je,c as At,T as Ht}from"./rc-tree-05a08686.js";import"./classnames-325479d5.js";const Rt=function(e){var t=r.useRef({valueLabels:new Map});return r.useMemo(function(){var n=t.current.valueLabels,u=new Map,l=e.map(function(o){var a,c=o.value,i=(a=o.label)!==null&&a!==void 0?a:n.get(c);return u.set(c,i),T(T({},o),{},{label:i})});return t.current.valueLabels=u,[l]},[e])},$t=function(e,t,n,u){return r.useMemo(function(){var l=e.map(function(i){var s=i.value;return s}),o=t.map(function(i){var s=i.value;return s}),a=l.filter(function(i){return!u[i]});if(n){var c=Je(l,!0,u);l=c.checkedKeys,o=c.halfCheckedKeys}return[Array.from(new Set([].concat(j(a),j(l)))),o]},[e,t,n,u])};function Ft(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Wt(e){var t=e||{},n=t.label,u=t.value,l=t.children,o=u||"value";return{_title:n?[n]:["title","label"],value:o,key:o,children:l||"children"}}function Ye(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function jt(e,t){var n=[];function u(l){l.forEach(function(o){var a=o[t.children];a&&(n.push(o[t.value]),u(a))})}return u(e),n}function ot(e){return e==null}const Ut=function(e,t){return r.useMemo(function(){var n=At(e,{fieldNames:t,initWrapper:function(l){return T(T({},l),{},{valueEntities:new Map})},processEntity:function(l,o){var a=l.node[t.value];o.valueEntities.set(a,l)}});return n},[e,t])};var vt=function(){return null},Bt=["children","value"];function ht(e){return Tt(e).map(function(t){if(!r.isValidElement(t)||!t.type)return null;var n=t,u=n.key,l=n.props,o=l.children,a=l.value,c=st(l,Bt),i=T({key:u,value:a},c),s=ht(o);return s.length&&(i.children=s),i}).filter(function(t){return t})}function ze(e){if(!e)return e;var t=T({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return Re(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function Gt(e,t,n,u,l,o){var a=null,c=null;function i(){function s(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return f.map(function(C,P){var D="".concat(I,"-").concat(P),V=C[o.value],H=n.includes(V),B=s(C[o.children]||[],D,H),R=r.createElement(vt,C,B.map(function(L){return L.node}));if(t===V&&(a=R),H){var S={pos:D,node:R,children:B};return k||c.push(S),S}return null}).filter(function(C){return C})}c||(c=[],s(u),c.sort(function(f,I){var k=f.node.props.value,C=I.node.props.value,P=n.indexOf(k),D=n.indexOf(C);return P-D}))}Object.defineProperty(e,"triggerNode",{get:function(){return Re(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),i(),a}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return Re(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),i(),l?c:c.map(function(f){var I=f.node;return I})}})}const qt=function(e,t,n){var u=n.treeNodeFilterProp,l=n.filterTreeNode,o=n.fieldNames,a=o.children;return r.useMemo(function(){if(!t||l===!1)return e;var c;if(typeof l=="function")c=l;else{var i=t.toUpperCase();c=function(I,k){var C=k[u];return String(C).toUpperCase().includes(i)}}function s(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return f.reduce(function(k,C){var P=C[a],D=I||c(t,ze(C)),V=s(P||[],D);return(D||V.length)&&k.push(T(T({},C),{},_t({isLeaf:void 0},a,V))),k},[])}return s(e)},[e,t,a,u,l])};function ct(e){var t=r.useRef();t.current=e;var n=r.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}function Jt(e,t){var n=t.id,u=t.pId,l=t.rootPId,o={},a=[],c=e.map(function(i){var s=T({},i),f=s[n];return o[f]=s,s.key=s.key||f,s});return c.forEach(function(i){var s=i[u],f=o[s];f&&(f.children=f.children||[],f.children.push(i)),(s===l||!f&&l===null)&&a.push(i)}),a}function Yt(e,t,n){return r.useMemo(function(){return e?n?Jt(e,T({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:ht(t)},[t,n,e])}var pt=r.createContext(null),mt=r.createContext(null),zt={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Qt=function(t,n){var u=Mt(),l=u.prefixCls,o=u.multiple,a=u.searchValue,c=u.toggleOpen,i=u.open,s=u.notFoundContent,f=r.useContext(mt),I=f.virtual,k=f.listHeight,C=f.listItemHeight,P=f.listItemScrollOffset,D=f.treeData,V=f.fieldNames,H=f.onSelect,B=f.dropdownMatchSelectWidth,R=f.treeExpandAction,S=r.useContext(pt),L=S.checkable,x=S.checkedKeys,Ce=S.halfCheckedKeys,Q=S.treeExpandedKeys,Fe=S.treeDefaultExpandAll,We=S.treeDefaultExpandedKeys,be=S.onTreeExpand,Ee=S.treeIcon,ke=S.showTreeIcon,xe=S.switcherIcon,De=S.treeLine,we=S.treeNodeFilterProp,Ie=S.loadData,ie=S.treeLoadedKeys,Le=S.treeMotion,Ke=S.onTreeLoad,Te=S.keyEntities,G=r.useRef(),ue=Vt(function(){return D},[i,D],function(b,h){return h[0]&&b[1]!==h[1]}),Ve=r.useState(null),oe=U(Ve,2),X=oe[0],Z=oe[1],A=Te[X],ce=r.useMemo(function(){return L?{checked:x,halfChecked:Ce}:null},[L,x,Ce]);r.useEffect(function(){if(i&&!o&&x.length){var b;(b=G.current)===null||b===void 0||b.scrollTo({key:x[0]}),Z(x[0])}},[i]);var de=String(a).toLowerCase(),_e=function(h){return de?String(h[we]).toLowerCase().includes(de):!1},Ne=r.useState(We),se=U(Ne,2),fe=se[0],je=se[1],Ue=r.useState(null),q=U(Ue,2),J=q[0],ve=q[1],N=r.useMemo(function(){return Q?j(Q):a?J:fe},[fe,J,Q,a]);r.useEffect(function(){a&&ve(jt(D,V))},[a]);var Be=function(h){je(h),ve(h),be&&be(h)},he=function(h){h.preventDefault()},$=function(h,ee){var M=ee.node;L&&Ye(M)||(H(M.key,{selected:!x.includes(M.key)}),o||c(!1))};if(r.useImperativeHandle(n,function(){var b;return{scrollTo:(b=G.current)===null||b===void 0?void 0:b.scrollTo,onKeyDown:function(ee){var M,Me=ee.which;switch(Me){case le.UP:case le.DOWN:case le.LEFT:case le.RIGHT:(M=G.current)===null||M===void 0||M.onKeyDown(ee);break;case le.ENTER:{if(A){var me=(A==null?void 0:A.node)||{},Ge=me.selectable,te=me.value;Ge!==!1&&$(null,{node:{key:X},selected:!x.includes(te)})}break}case le.ESC:c(!1)}},onKeyUp:function(){}}}),ue.length===0)return r.createElement("div",{role:"listbox",className:"".concat(l,"-empty"),onMouseDown:he},s);var pe={fieldNames:V};return ie&&(pe.loadedKeys=ie),N&&(pe.expandedKeys=N),r.createElement("div",{onMouseDown:he},A&&i&&r.createElement("span",{style:zt,"aria-live":"assertive"},A.node.value),r.createElement(Ht,ft({ref:G,focusable:!1,prefixCls:"".concat(l,"-tree"),treeData:ue,height:k,itemHeight:C,itemScrollOffset:P,virtual:I!==!1&&B!==!1,multiple:o,icon:Ee,showIcon:ke,switcherIcon:xe,showLine:De,loadData:a?null:Ie,motion:Le,activeKey:X,checkable:L,checkStrictly:!0,checkedKeys:ce,selectedKeys:L?[]:x,defaultExpandAll:Fe},pe,{onActiveChange:Z,onSelect:$,onCheck:$,onExpand:Be,onLoad:Ke,filterTreeNode:_e,expandAction:R})))},gt=r.forwardRef(Qt);gt.displayName="OptionList";var yt="SHOW_ALL",St="SHOW_PARENT",Qe="SHOW_CHILD";function dt(e,t,n,u){var l=new Set(e);return t===Qe?e.filter(function(o){var a=n[o];return!(a&&a.children&&a.children.some(function(c){var i=c.node;return l.has(i[u.value])})&&a.children.every(function(c){var i=c.node;return Ye(i)||l.has(i[u.value])}))}):t===St?e.filter(function(o){var a=n[o],c=a?a.parent:null;return!(c&&!Ye(c.node)&&l.has(c.key))}):e}var Xt=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"];function Zt(e){return!e||Nt(e)!=="object"}var er=r.forwardRef(function(e,t){var n=e.id,u=e.prefixCls,l=u===void 0?"rc-tree-select":u,o=e.value,a=e.defaultValue,c=e.onChange,i=e.onSelect,s=e.onDeselect,f=e.searchValue,I=e.inputValue,k=e.onSearch,C=e.autoClearSearchValue,P=C===void 0?!0:C,D=e.filterTreeNode,V=e.treeNodeFilterProp,H=V===void 0?"value":V,B=e.showCheckedStrategy,R=e.treeNodeLabelProp,S=e.multiple,L=e.treeCheckable,x=e.treeCheckStrictly,Ce=e.labelInValue,Q=e.fieldNames,Fe=e.treeDataSimpleMode,We=e.treeData,be=e.children,Ee=e.loadData,ke=e.treeLoadedKeys,xe=e.onTreeLoad,De=e.treeDefaultExpandAll,we=e.treeExpandedKeys,Ie=e.treeDefaultExpandedKeys,ie=e.onTreeExpand,Le=e.treeExpandAction,Ke=e.virtual,Te=e.listHeight,G=Te===void 0?200:Te,ue=e.listItemHeight,Ve=ue===void 0?20:ue,oe=e.listItemScrollOffset,X=oe===void 0?0:oe,Z=e.onDropdownVisibleChange,A=e.dropdownMatchSelectWidth,ce=A===void 0?!0:A,de=e.treeLine,_e=e.treeIcon,Ne=e.showTreeIcon,se=e.switcherIcon,fe=e.treeMotion,je=st(e,Xt),Ue=Ot(n),q=L&&!x,J=L||x,ve=x||Ce,N=J||S,Be=ut(a,{value:o}),he=U(Be,2),$=he[0],pe=he[1],b=r.useMemo(function(){return L?B||Qe:yt},[B,L]),h=r.useMemo(function(){return Wt(Q)},[JSON.stringify(Q)]),ee=ut("",{value:f!==void 0?f:I,postState:function(d){return d||""}}),M=U(ee,2),Me=M[0],me=M[1],Ge=function(d){me(d),k==null||k(d)},te=Yt(We,be,Fe),Xe=Ut(te,h),K=Xe.keyEntities,Y=Xe.valueEntities,Ze=r.useCallback(function(v){var d=[],p=[];return v.forEach(function(m){Y.has(m)?p.push(m):d.push(m)}),{missingRawValues:d,existRawValues:p}},[Y]),et=qt(te,Me,{fieldNames:h,treeNodeFilterProp:H,filterTreeNode:D}),tt=r.useCallback(function(v){if(v){if(R)return v[R];for(var d=h._title,p=0;p<d.length;p+=1){var m=v[d[p]];if(m!==void 0)return m}}},[h,R]),ge=r.useCallback(function(v){var d=Ft(v);return d.map(function(p){return Zt(p)?{value:p}:p})},[]),Oe=r.useCallback(function(v){var d=ge(v);return d.map(function(p){var m=p.label,w=p.value,E=p.halfChecked,g,y=Y.get(w);if(y){var _;m=(_=m)!==null&&_!==void 0?_:tt(y.node),g=y.node.disabled}else if(m===void 0){var F=ge($).find(function(ye){return ye.value===w});m=F.label}return{label:m,value:w,halfChecked:E,disabled:g}})},[Y,tt,ge,$]),rt=r.useMemo(function(){return ge($)},[ge,$]),Ct=r.useMemo(function(){var v=[],d=[];return rt.forEach(function(p){p.halfChecked?d.push(p):v.push(p)}),[v,d]},[rt]),nt=U(Ct,2),re=nt[0],at=nt[1],lt=r.useMemo(function(){return re.map(function(v){return v.value})},[re]),bt=$t(re,at,q,K),it=U(bt,2),ne=it[0],Pe=it[1],Et=r.useMemo(function(){var v=dt(ne,b,K,h),d=v.map(function(E){var g,y;return(g=(y=K[E])===null||y===void 0||(y=y.node)===null||y===void 0?void 0:y[h.value])!==null&&g!==void 0?g:E}),p=d.map(function(E){var g=re.find(function(y){return y.value===E});return{value:E,label:g==null?void 0:g.label}}),m=Oe(p),w=m[0];return!N&&w&&ot(w.value)&&ot(w.label)?[]:m.map(function(E){var g;return T(T({},E),{},{label:(g=E.label)!==null&&g!==void 0?g:E.value})})},[h,N,ne,re,Oe,b,K]),kt=Rt(Et),xt=U(kt,1),Dt=xt[0],Ae=ct(function(v,d,p){var m=Oe(v);if(pe(m),P&&me(""),c){var w=v;if(q){var E=dt(v,b,K,h);w=E.map(function(O){var W=Y.get(O);return W?W.node[h.value]:O})}var g=d||{triggerValue:void 0,selected:void 0},y=g.triggerValue,_=g.selected,F=w;if(x){var ye=at.filter(function(O){return!w.includes(O.value)});F=[].concat(j(F),j(ye))}var Se=Oe(F),z={preValue:re,triggerValue:y},ae=!0;(x||p==="selection"&&!_)&&(ae=!1),Gt(z,y,v,te,ae,h),J?z.checked=_:z.selected=_;var He=ve?Se:Se.map(function(O){return O.value});c(N?He:He[0],ve?null:Se.map(function(O){return O.label}),z)}}),qe=r.useCallback(function(v,d){var p,m=d.selected,w=d.source,E=K[v],g=E==null?void 0:E.node,y=(p=g==null?void 0:g[h.value])!==null&&p!==void 0?p:v;if(!N)Ae([y],{selected:!0,triggerValue:y},"option");else{var _=m?[].concat(j(lt),[y]):ne.filter(function(W){return W!==y});if(q){var F=Ze(_),ye=F.missingRawValues,Se=F.existRawValues,z=Se.map(function(W){return Y.get(W).key}),ae;if(m){var He=Je(z,!0,K);ae=He.checkedKeys}else{var O=Je(z,{checked:!1,halfCheckedKeys:Pe},K);ae=O.checkedKeys}_=[].concat(j(ye),j(ae.map(function(W){return K[W].node[h.value]})))}Ae(_,{selected:m,triggerValue:y},w||"option")}m||!N?i==null||i(y,ze(g)):s==null||s(y,ze(g))},[Ze,Y,K,h,N,lt,Ae,q,i,s,ne,Pe]),wt=r.useCallback(function(v){if(Z){var d={};Object.defineProperty(d,"documentClickClose",{get:function(){return Re(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),Z(v,d)}},[Z]),It=ct(function(v,d){var p=v.map(function(m){return m.value});if(d.type==="clear"){Ae(p,{},"selection");return}d.values.length&&qe(d.values[0].value,{selected:!1,source:"selection"})}),Lt=r.useMemo(function(){return{virtual:Ke,dropdownMatchSelectWidth:ce,listHeight:G,listItemHeight:Ve,listItemScrollOffset:X,treeData:et,fieldNames:h,onSelect:qe,treeExpandAction:Le}},[Ke,ce,G,Ve,X,et,h,qe,Le]),Kt=r.useMemo(function(){return{checkable:J,loadData:Ee,treeLoadedKeys:ke,onTreeLoad:xe,checkedKeys:ne,halfCheckedKeys:Pe,treeDefaultExpandAll:De,treeExpandedKeys:we,treeDefaultExpandedKeys:Ie,onTreeExpand:ie,treeIcon:_e,treeMotion:fe,showTreeIcon:Ne,switcherIcon:se,treeLine:de,treeNodeFilterProp:H,keyEntities:K}},[J,Ee,ke,xe,ne,Pe,De,we,Ie,ie,_e,fe,Ne,se,de,H,K]);return r.createElement(mt.Provider,{value:Lt},r.createElement(pt.Provider,{value:Kt},r.createElement(Pt,ft({ref:t},je,{id:Ue,prefixCls:l,mode:N?"multiple":void 0,displayValues:Dt,onDisplayValuesChange:It,searchValue:Me,onSearch:Ge,OptionList:gt,emptyOptions:!te.length,onDropdownVisibleChange:wt,dropdownMatchSelectWidth:ce}))))}),$e=er;$e.TreeNode=vt;$e.SHOW_ALL=yt;$e.SHOW_PARENT=St;$e.SHOW_CHILD=Qe;export{$e as G,yt as S,vt as T,St as a,Qe as b};
